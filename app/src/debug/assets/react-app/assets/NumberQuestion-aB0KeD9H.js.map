{"version":3,"file":"NumberQuestion-aB0KeD9H.js","sources":["../../src/components/Questions/Number/NumberQuestion.jsx"],"sourcesContent":["import React from \"react\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport TextField from \"@mui/material/TextField\";\nimport styles from \"./NumberQuestion.module.css\";\nimport { useTheme } from \"@mui/material/styles\";\nimport { valueChange } from \"~/state/runState\";\nimport { setDirty } from \"~/state/templateState\";\n\nfunction NumberQuestion(props) {\n  const theme = useTheme();\n  const state = useSelector((state) => {\n    let questionState = state.runState.values[props.component.qualifiedCode];\n    let show_errors = state.runState.values.Survey.show_errors;\n    let isDirty = state.templateState[props.component.qualifiedCode];\n    let validity = questionState?.validity;\n    let invalid = (show_errors || isDirty) && validity === false;\n    return {\n      value: questionState?.value,\n      invalid: invalid,\n    };\n  }, shallowEqual);\n  const dispatch = useDispatch();\n\n  const cleanupValue = (oldValue, newValue) => {\n    const regex =\n      props.component.decimal_separator == \".\"\n        ? /^[0-9]+\\.?[0-9]*$/\n        : props.component.decimal_separator == \",\"\n          ? /^[0-9]+,?[0-9]*$/\n          : /^[0-9]*$/;\n    if (newValue == \"\") {\n      return undefined;\n    }\n    if (regex.test(newValue)) {\n      let withDecimal = convertToDecimal(newValue)\n      let processed = +withDecimal;\n      let returning = isNaN(processed) ? oldValue : withDecimal;\n      return returning;\n    } else {\n      return oldValue;\n    }\n  };\n\n  const convertToDecimal = (value) => {\n    if (props.component.decimal_separator != \",\") {\n      return value;\n    }\n    let stringValue = value.toString();\n    return stringValue.replace(\",\", \".\");\n  };\n\n  const formatValue = (value) => {\n    return value === undefined\n      ? \"\"\n      : props.component.decimal_separator == \",\"\n        ? value.toString().replace(\".\", \",\")\n        : value;\n  };\n\n  const handleChange = (event) => {\n    dispatch(\n      valueChange({\n        componentCode: event.target.name,\n        value: cleanupValue(state.value, event.target.value),\n      })\n    );\n  };\n\n  const lostFocus = (event) => {\n    dispatch(setDirty(event.target.name));\n    let processed = +state.value;\n    if (!isNaN(processed)) {\n      dispatch(\n        valueChange({\n          componentCode: props.component.qualifiedCode,\n          value: processed,\n        })\n      );\n    }\n  };\n\n  return (\n    <div className={styles.questionItem}>\n      <TextField\n        variant=\"outlined\"\n        required={\n          props.component.validation?.validation_required?.isActive\n            ? true\n            : false\n        }\n        size=\"small\"\n        id={props.component.qualifiedCode}\n        name={props.component.qualifiedCode}\n        label={(props.component.showHint && props.component.content?.hint )|| \"\"}\n        onChange={handleChange}\n        onBlur={lostFocus}\n        inputProps={{ maxLength: props.component.maxChars || undefined }}\n        value={formatValue(state.value)}\n        error={state.invalid}\n        InputProps={{\n          sx: {\n            fontFamily: theme.textStyles.text.font,\n            color: theme.textStyles.text.color,\n            fontSize: theme.textStyles.text.size,\n\n          },\n        }}\n      />\n    </div>\n  );\n}\n\nexport default NumberQuestion;\n"],"names":["state","jsx"],"mappings":";;;;;;AAQA,SAAS,eAAe,OAAO;;AAC7B,QAAM,QAAQ,SAAA;AACd,QAAM,QAAQ,YAAY,CAACA,WAAU;AACnC,QAAI,gBAAgBA,OAAM,SAAS,OAAO,MAAM,UAAU,aAAa;AACvE,QAAI,cAAcA,OAAM,SAAS,OAAO,OAAO;AAC/C,QAAI,UAAUA,OAAM,cAAc,MAAM,UAAU,aAAa;AAC/D,QAAI,WAAW,+CAAe;AAC9B,QAAI,WAAW,eAAe,YAAY,aAAa;AACvD,WAAO;AAAA,MACL,OAAO,+CAAe;AAAA,MACtB;AAAA,IAAA;AAAA,EAEJ,GAAG,YAAY;AACf,QAAM,WAAW,YAAA;AAEjB,QAAM,eAAe,CAAC,UAAU,aAAa;AAC3C,UAAM,QACJ,MAAM,UAAU,qBAAqB,MACjC,sBACA,MAAM,UAAU,qBAAqB,MACnC,qBACA;AACR,QAAI,YAAY,IAAI;AAClB,aAAO;AAAA,IACT;AACA,QAAI,MAAM,KAAK,QAAQ,GAAG;AACxB,UAAI,cAAc,iBAAiB,QAAQ;AAC3C,UAAI,YAAY,CAAC;AACjB,UAAI,YAAY,MAAM,SAAS,IAAI,WAAW;AAC9C,aAAO;AAAA,IACT,OAAO;AACL,aAAO;AAAA,IACT;AAAA,EACF;AAEA,QAAM,mBAAmB,CAAC,UAAU;AAClC,QAAI,MAAM,UAAU,qBAAqB,KAAK;AAC5C,aAAO;AAAA,IACT;AACA,QAAI,cAAc,MAAM,SAAA;AACxB,WAAO,YAAY,QAAQ,KAAK,GAAG;AAAA,EACrC;AAEA,QAAM,cAAc,CAAC,UAAU;AAC7B,WAAO,UAAU,SACb,KACA,MAAM,UAAU,qBAAqB,MACnC,MAAM,SAAA,EAAW,QAAQ,KAAK,GAAG,IACjC;AAAA,EACR;AAEA,QAAM,eAAe,CAAC,UAAU;AAC9B;AAAA,MACE,YAAY;AAAA,QACV,eAAe,MAAM,OAAO;AAAA,QAC5B,OAAO,aAAa,MAAM,OAAO,MAAM,OAAO,KAAK;AAAA,MAAA,CACpD;AAAA,IAAA;AAAA,EAEL;AAEA,QAAM,YAAY,CAAC,UAAU;AAC3B,aAAS,SAAS,MAAM,OAAO,IAAI,CAAC;AACpC,QAAI,YAAY,CAAC,MAAM;AACvB,QAAI,CAAC,MAAM,SAAS,GAAG;AACrB;AAAA,QACE,YAAY;AAAA,UACV,eAAe,MAAM,UAAU;AAAA,UAC/B,OAAO;AAAA,QAAA,CACR;AAAA,MAAA;AAAA,IAEL;AAAA,EACF;AAEA,SACEC,kCAAAA,IAAC,OAAA,EAAI,WAAW,OAAO,cACrB,UAAAA,kCAAAA;AAAAA,IAAC;AAAA,IAAA;AAAA,MACC,SAAQ;AAAA,MACR,YACE,iBAAM,UAAU,eAAhB,mBAA4B,wBAA5B,mBAAiD,YAC7C,OACA;AAAA,MAEN,MAAK;AAAA,MACL,IAAI,MAAM,UAAU;AAAA,MACpB,MAAM,MAAM,UAAU;AAAA,MACtB,OAAQ,MAAM,UAAU,cAAY,WAAM,UAAU,YAAhB,mBAAyB,SAAS;AAAA,MACtE,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,YAAY,EAAE,WAAW,MAAM,UAAU,YAAY,OAAA;AAAA,MACrD,OAAO,YAAY,MAAM,KAAK;AAAA,MAC9B,OAAO,MAAM;AAAA,MACb,YAAY;AAAA,QACV,IAAI;AAAA,UACF,YAAY,MAAM,WAAW,KAAK;AAAA,UAClC,OAAO,MAAM,WAAW,KAAK;AAAA,UAC7B,UAAU,MAAM,WAAW,KAAK;AAAA,QAAA;AAAA,MAElC;AAAA,IACF;AAAA,EAAA,GAEJ;AAEJ;"}