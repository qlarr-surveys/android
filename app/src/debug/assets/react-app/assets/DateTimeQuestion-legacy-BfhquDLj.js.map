{"version":3,"file":"DateTimeQuestion-legacy-BfhquDLj.js","sources":["../../src/components/Questions/DateTime/DateTimeQuestion.jsx"],"sourcesContent":["import React from \"react\";\nimport TextField from \"@mui/material/TextField\";\nimport { TimePicker } from \"@mui/x-date-pickers/TimePicker\";\nimport { DatePicker } from \"@mui/x-date-pickers/DatePicker\";\nimport { DateTimePicker } from \"@mui/x-date-pickers/DateTimePicker\";\nimport { LocalizationProvider } from \"@mui/x-date-pickers/LocalizationProvider\";\nimport { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport dayjs from \"dayjs\";\n\nimport styles from \"./DateTimeQuestion.module.css\";\nimport { useTheme } from \"@mui/system\";\nimport { valueChange } from \"~/state/runState\";\n\nfunction DateTimeQuestion(props) {\n  const theme = useTheme();\n\n  const state = useSelector((state) => {\n    let own = state.runState.values[props.component.qualifiedCode];\n    let show_errors = state.runState.values.Survey.show_errors;\n    let isDirty = state.templateState[props.component.qualifiedCode];\n    return {\n      invalid: (show_errors || isDirty) && own?.validity === false,\n      value: own?.value\n        ? dayjs(window.QlarrScripts.sqlDateTimeToDate(own?.value))\n        : null,\n    };\n  }, shallowEqual);\n  const dispatch = useDispatch();\n\n  const handleDateChange = (date) => {\n    let finalDate = date === null ? undefined : date.toDate();\n    dispatch(\n      valueChange({\n        componentCode: props.component.qualifiedCode,\n\n        value:\n          props.component.type == \"date_time\"\n            ? window.QlarrScripts.toSqlDateTime(finalDate)\n            : props.component.type == \"time\"\n              ? window.QlarrScripts.toSqlDateTimeIgnoreDate(finalDate)\n              : window.QlarrScripts.toSqlDateTimeIgnoreTime(finalDate),\n      })\n    );\n  };\n\n  const dateFormat = props.component.dateFormat\n    ? props.component.dateFormat\n    : \"DD.MM.YYYY\";\n\n  return (\n    <div className={styles.wrapper}>\n      <LocalizationProvider dateAdapter={AdapterDayjs} adapterLocale=\"ar-sa\">\n        {props.component.type == \"date_time\" ? (\n          <>\n            <DateTimePicker\n              renderInput={(props) => (\n                <TextField\n                  sx={{\n                    svg: { color: theme.textStyles.text.color },\n                    border: '1px solid',\n                    '& .MuiOutlinedInput-root': {\n                      '&.Mui-focused fieldset': {\n                        borderColor: theme.textStyles.text.color,\n                      },\n                    },\n                  }}\n                  onKeyDown={(e) => e.preventDefault()} {...props} />\n              )}\n              margin=\"normal\"\n              value={state.value}\n              inputFormat={\n                dateFormat +\n                \" \" +\n                (props.component.fullDayFormat ? \"HH:mm\" : \"hh:mm A\")\n              }\n              PaperProps={{\n                sx: {\n                  backgroundColor: 'white',\n                  \"& .MuiPickersDay-root\": {\n                    backgroundColor: 'white',\n                  },\n                },\n              }}\n\n              ampm={props.component.fullDayFormat ? false : true}\n              openTo=\"year\"\n              views={[\"year\", \"month\", \"day\", \"hours\", \"minutes\"]}\n              id={props.component.qualifiedCode}\n              minDate={\n                props.component.minDate\n                  ? dayjs(\n                    window.QlarrScripts.dateStringToDate(\n                      props.component.minDate\n                    )\n                  )\n                  : undefined\n              }\n              maxDate={\n                props.component.maxDate\n                  ? dayjs(\n                    window.QlarrScripts.dateStringToDate(\n                      props.component.maxDate\n                    )\n                  )\n                  : undefined\n              }\n              error={state.invalid}\n              onChange={handleDateChange}\n              InputProps={{\n                sx: {\n                  fontFamily: theme.textStyles.text.font,\n                  fontSize: theme.textStyles.text.size,\n                  color: theme.textStyles.text.color,\n                },\n              }}\n            />\n          </>\n        ) : props.component.type == \"time\" ? (\n          <TimePicker\n            renderInput={(params) => (\n              <TextField\n                sx={{\n                  svg: { color: theme.textStyles.text.color },\n                  border: '1px solid',\n                  '& .MuiOutlinedInput-root': {\n                    '&.Mui-focused fieldset': {\n                      borderColor: theme.textStyles.text.color,\n                    },\n                  },\n                }}\n                onKeyDown={(e) => e.preventDefault()} {...params} />\n            )}\n            margin=\"normal\"\n            openTo=\"hours\"\n            views={[\"hours\", \"minutes\"]}\n            ampm={props.component.fullDayFormat ? false : true}\n            inputFormat={props.component.fullDayFormat ? \"HH:mm\" : \"hh:mm A\"}\n            id={props.component.qualifiedCode}\n            value={state.value}\n            error={state.invalid}\n            onChange={handleDateChange}\n            PaperProps={{\n              sx: {\n                backgroundColor: 'white',\n                \"& .MuiPickersDay-root\": {\n                  backgroundColor: 'white',\n                },\n              },\n            }}\n\n            InputProps={{\n              sx: {\n                fontFamily: theme.textStyles.text.font,\n                color: theme.textStyles.text.color,\n                fontSize: theme.textStyles.text.size\n              },\n            }}\n          />\n        ) : (\n          <DatePicker\n            renderInput={(params) => (\n              <TextField\n                sx={{\n                  svg: { color: theme.textStyles.text.color },\n                  input: { color: theme.textStyles.text.color },\n                  border: '1px solid',\n                  '& .MuiOutlinedInput-root': {\n                    '&.Mui-focused fieldset': {\n                      borderColor: theme.textStyles.text.color,\n                    },\n                  },\n                }}\n\n                onKeyDown={(e) => e.preventDefault()} {...params} />\n            )}\n            margin=\"normal\"\n            openTo=\"year\"\n            views={[\"year\", \"month\", \"day\"]}\n            ampm={props.component.fullDayFormat ? false : true}\n            id={props.component.qualifiedCode}\n            inputFormat={dateFormat}\n            value={state.value}\n            minDate={\n              props.component.minDate\n                ? window.QlarrScripts.dateStringToDate(\n                  props.component.minDate\n                )\n                : undefined\n            }\n            PaperProps={{\n              sx: {\n                backgroundColor: 'white',\n                \"& .MuiPickersDay-root\": {\n                  backgroundColor: 'white',\n                },\n              },\n            }}\n            maxDate={\n              props.component.maxDate\n                ? window.QlarrScripts.dateStringToDate(\n                  props.component.maxDate\n                )\n                : undefined\n            }\n            error={state.invalid}\n            onChange={handleDateChange}\n            InputProps={{\n              sx: {\n                fontFamily: theme.textStyles.text.font,\n                fontSize: theme.textStyles.text.size,\n              },\n            }}\n          />\n        )}\n      </LocalizationProvider>\n    </div>\n  );\n}\n\nexport default DateTimeQuestion;\n"],"names":["DateTimeQuestion","props","theme","useTheme","state","useSelector","own","runState","values","component","qualifiedCode","show_errors","Survey","isDirty","templateState","invalid","validity","value","dayjs","window","QlarrScripts","sqlDateTimeToDate","shallowEqual","dispatch","useDispatch","handleDateChange","date","finalDate","toDate","valueChange","componentCode","type","toSqlDateTime","toSqlDateTimeIgnoreDate","toSqlDateTimeIgnoreTime","dateFormat","jsx","className","styles","wrapper","children","LocalizationProvider","dateAdapter","AdapterDayjs","adapterLocale","Fragment","DateTimePicker","renderInput","TextField","_objectSpread","sx","svg","color","textStyles","text","border","borderColor","onKeyDown","e","preventDefault","margin","inputFormat","fullDayFormat","PaperProps","backgroundColor","ampm","openTo","views","id","minDate","dateStringToDate","maxDate","error","onChange","InputProps","fontFamily","font","fontSize","size","TimePicker","params","DatePicker","input"],"mappings":"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"}