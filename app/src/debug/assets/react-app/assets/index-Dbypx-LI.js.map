{"version":3,"file":"index-Dbypx-LI.js","sources":["../../src/pages/manage/Login/index.jsx"],"sourcesContent":["import * as Yup from \"yup\";\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\n\nimport Link from \"@mui/material/Link\";\nimport Stack from \"@mui/material/Stack\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Typography from \"@mui/material/Typography\";\nimport LoadingButton from \"@mui/lab/LoadingButton\";\nimport InputAdornment from \"@mui/material/InputAdornment\";\nimport { useBoolean } from \"../../../hooks/use-boolean\";\nimport FormProvider, { RHFTextField } from \"../../../components/hook-form\";\nimport Iconify from \"~/components/iconify\";\nimport { useDispatch } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { setLoading } from \"~/state/edit/editState\";\nimport RouterLink from \"~/components/router/router-link\";\nimport { useTranslation } from \"react-i18next\";\nimport { PROCESSED_ERRORS } from \"~/utils/errorsProcessor\";\nimport { useService } from \"~/hooks/use-service\";\n\n// ----------------------------------------------------------------------\n\nexport default function LoginView() {\n  const authService = useService(\"auth\");\n\n  const { t } = useTranslation(\"manage\");\n\n  const passwordShow = useBoolean();\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const LoginSchema = Yup.object().shape({\n    email: Yup.string()\n      .required(t(\"email_required\"))\n      .matches(\n        /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$/i,\n        t(\"error.invalid_email\")\n      ),\n    password: Yup.string().required(t(\"password_required\")),\n  });\n\n  const defaultValues = {\n    email: \"\",\n    password: \"\",\n  };\n\n  const methods = useForm({\n    resolver: yupResolver(LoginSchema),\n    defaultValues,\n  });\n\n  const {\n    setError,\n    handleSubmit,\n    formState: { isSubmitting },\n  } = methods;\n\n  const handleError = (processedError) => {\n    if (processedError.name == PROCESSED_ERRORS.WRONG_CREDENTIALS.name) {\n      setError(\"email\", {\n        type: \"manual\",\n        message: t(`processed_errors.${processedError.name}`),\n      });\n      setError(\"password\", {\n        type: \"manual\",\n        message: t(`processed_errors.${processedError.name}`),\n      });\n    }\n  };\n\n  const onSubmit = handleSubmit(async (data) => {\n    dispatch(setLoading(true));\n    try {\n      await authService.login(data.email, data.password);\n      const { from } = location.state || { from: { pathname: \"/\" } };\n      navigate(from);\n    } catch (e) {\n      handleError(e);\n    } finally {\n      dispatch(setLoading(false));\n    }\n  });\n\n\n  const renderHead = (\n    <div>\n      <Typography variant=\"h3\" paragraph>\n        {t(\"login.login\")}\n      </Typography>\n    </div>\n  );\n\n\n  const renderForm = (\n    <FormProvider methods={methods} onSubmit={handleSubmit(onSubmit)}>\n      <Stack spacing={2.5} alignItems=\"flex-end\">\n        <RHFTextField name=\"email\" label={t(\"label.email\")} />\n\n        <RHFTextField\n          name=\"password\"\n          label={t(\"label.password\")}\n          type={passwordShow.value ? \"text\" : \"password\"}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <IconButton onClick={passwordShow.onToggle} edge=\"end\">\n                  <Iconify\n                    icon={\n                      passwordShow.value ? \"carbon:view\" : \"carbon:view-off\"\n                    }\n                  />\n                </IconButton>\n              </InputAdornment>\n            ),\n          }}\n        />\n\n        <Link\n          component={RouterLink}\n          href=\"/forgot-password\"\n          variant=\"body2\"\n          underline=\"always\"\n          color=\"text.secondary\"\n        >\n          {t(\"login.forgot_password\")}\n        </Link>\n\n        <LoadingButton\n          fullWidth\n          color=\"primary\"\n          size=\"large\"\n          type=\"submit\"\n          variant=\"contained\"\n          loading={isSubmitting}\n        >\n          {t(\"login.login\")}\n        </LoadingButton>\n      </Stack>\n    </FormProvider>\n  );\n\n  return (\n    <>\n      {renderHead}\n\n      {renderForm}\n    </>\n  );\n}\n"],"names":["Yup.object","Yup.string","yupResolver","jsx","jsxs","Fragment"],"mappings":"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"}