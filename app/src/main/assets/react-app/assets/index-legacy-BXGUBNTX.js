!function(){function e(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function r(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?e(Object(a),!0).forEach((function(e){n(r,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))}))}return r}function n(e,r,n){var t;return(r="symbol"==typeof(t=function(e,r){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"))?t:String(t))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function t(e,r,n,t,a,i,s){try{var o=e[i](s),l=o.value}catch(c){return void n(c)}o.done?r(l):Promise.resolve(l).then(t,a)}function a(e){return function(){var r=this,n=arguments;return new Promise((function(a,i){var s=e.apply(r,n);function o(e){t(s,a,i,o,l,"next",e)}function l(e){t(s,a,i,o,l,"throw",e)}o(void 0)}))}}function i(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i,s,o=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(t=i.call(n)).done)&&(o.push(t.value),o.length!==r);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return s(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}System.register(["./index-legacy-DMBe9EAg.js","./yup-legacy-C3aTvBsi.js","./Web-legacy-yvcV3pU-.js","./use-service-legacy-CgI9X4sP.js","./use-boolean-legacy-CDioL4gv.js","./TextField-legacy-QXvJQCtl.js","./LoadingButton-legacy-BX6tsN0p.js","./Link-legacy-EkQEaKQD.js","./index-legacy-DzYt31mA.js","./InputAdornment-legacy-BhuVi7XQ.js","./Checkbox-legacy-DMb0Vmp_.js","./SwitchBase-legacy-Cc5oLAc3.js","./useFormControl-legacy-CjmSkc-O.js","./Tabs-legacy-C8lKUr6-.js","./radioClasses-legacy-BKKEz_sy.js","./tableRowClasses-legacy-CPFVA4RK.js","./FormControlLabel-legacy--V8-R9RI.js"],(function(e,n){"use strict";var t,s,o,l,c,d,u,m,f,p,h,b,x,g,j,y,v,w,_,N,A,E,C,P,S,O,I,q,G,D,H,L,k,z,W,T;return{setters:[e=>{t=e.r,s=e.j,o=e.B,l=e.s},e=>{c=e.c,d=e.a,u=e.o,m=e.d,f=e.b},e=>{p=e.u,h=e.F,b=e.o,x=e.I,g=e.R,j=e.a,y=e.A,v=e.r},e=>{w=e.A,_=e.am,N=e.a3,A=e.T,E=e.an,C=e.v,P=e.y,S=e.w,O=e.D,I=e.F,q=e.ao,G=e.al,D=e.I},e=>{H=e.u},e=>{L=e.j},e=>{k=e.L},e=>{z=e.L},e=>{W=e.S},e=>{T=e.I},null,null,null,null,null,null,null],execute:function(){var n=document.createElement("style");n.textContent="._verifyContainer_rwmnr_1{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:-24px 24px 72px -8px rgba(145,158,171,.24);padding:32px;border-radius:16px;width:400px;background-color:#fff}\n",document.head.appendChild(n),e("default",(function(){const e=w("auth"),n=w("user"),b=l(),N=C((e=>e.editState.loading)),E=P("manage").t,L=H(),z=S.getUser().id,R=i(t.useState({}),2),F=R[0],U=R[1],Z=i(t.useState(!1),2),V=Z[0],B=Z[1],J=i(t.useState(!1),2),K=J[0],Q=J[1],X=i(t.useState(!1),2),Y=X[0],ee=X[1],re=i(t.useState(!1),2),ne=re[0],te=re[1],ae=i(t.useState($.NONE),2),ie=ae[0],se=ae[1],oe=O(),le=()=>{ee(!1)};m(d,"noWhitespace",(function(e){return this.test("no-whitespace",e,(function(r){const n=this.path,t=this.createError;return!(null==r||!r.trim())||t({path:n,message:e})}))}));const ce=e=>{let n={firstName:d().required(E("firstname_required")).noWhitespace(E("error.invalid_first_name")).max(50,E("error.first_name_too_long")).matches(/^[A-Za-z]+$/,E("error.invalid_first_name")),lastName:d().required(E("lastname_required")).noWhitespace(E("error.invalid_last_name")).max(50,E("error.last_name_too_long")).matches(/^[A-Za-z]+$/,E("error.invalid_last_name"))};return e===$.CHANGE_EMAIL&&(n=r(r({},n),{},{currentPassword:d().required(E("password_required")),email:d().required(E("email_required")).matches(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/i,E("error.invalid_email"))})),e===$.CHANGE_PASSWORD&&(n=r(r({},n),{},{currentPassword:d().required(E("password_required")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/,E("error.invalid_password")),newPassword:d().required(E("password_required")),confirmNewPassword:d().required(E("password_required")).oneOf([f("newPassword"),null],E("error.password_should_match"))})),c().shape(n)},de=ie===$.CHANGE_EMAIL||ie===$.CHANGE_PASSWORD;const ue=()=>{e.logout().then((()=>{b(v.login)})).catch((e=>{b(v.login)}))},me=p({resolver:u(ce(ie)),defaultValues:{firstName:"",lastName:"",email:"",currentPassword:"",newPassword:"",confirmNewPassword:""}}),fe=me.watch,pe=me.setError,he=me.reset,be=me.handleSubmit,xe=fe("email");t.useEffect((()=>{xe!==F.email?(he(r(r({},me.getValues()),{},{firstName:F.firstName,lastName:F.lastName})),Q(!0)):Q(!1)}),[xe,F.email,he,me]),t.useEffect((()=>{n.getUser({userId:z}).then((e=>{const r={firstName:e.firstName,lastName:e.lastName,email:e.email};U(e),he(r)}))}),[he,z]),t.useEffect((()=>{const e=ce(ie);me.reset(r({},me.getValues()),{errors:!0,schema:e})}),[ie,me]);const ge=be(function(){var e=a((function*(e){const r=e.firstName,t=e.lastName,a=e.email,i=e.newPassword,s=e.currentPassword,o={};F.firstName!==r&&(o.firstName=r),F.lastName!==t&&(o.lastName=t),F.email!==a&&(o.email=a),""!==s&&(o.password=s),""!==i&&(o.newPassword=i),oe(I(!0)),n.updateUserProfile(o).then((()=>{o.email&&o.email!==F.email?B(!0):de?ue():te(!0)})).catch((e=>{e.name==q.DUPLICATE_EMAIL.name?pe("email",{type:"manual",message:E(`processed_errors.${e.name}`)}):e.name==q.WRONG_CREDENTIALS.name&&pe("currentPassword",{type:"manual",message:E("error.incorrect_password")})})).finally((()=>{oe(I(!1))}))}));return function(r){return e.apply(this,arguments)}}());return s.jsxs(G,{children:[ne&&s.jsx(W,{success:"updated",left:"56"}),s.jsxs(h,{methods:me,onSubmit:ge,children:[s.jsx(A,{variant:"h5",sx:{mb:3},children:"Personal"}),s.jsxs(o,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[s.jsx(g,{disabled:K,name:"firstName",label:E("label.first_name")}),s.jsx(g,{disabled:K,name:"lastName",label:E("label.last_name")}),s.jsx(g,{disabled:ie!=$.CHANGE_EMAIL,name:"email",label:E("label.email")})]}),s.jsx(_,{spacing:3,sx:{my:5},children:s.jsxs(s.Fragment,{children:[ie==$.CHANGE_PASSWORD&&s.jsxs("div",{children:[s.jsx(A,{variant:"h5",children:E("profile.change_password")}),s.jsx(A,{variant:"body2",sx:{color:"error.main",mb:1},children:E("profile.hint")})]}),ie==$.CHANGE_EMAIL&&s.jsx(A,{variant:"body2",sx:{color:"error.main"},children:E("profile.hint")}),s.jsxs(_,{spacing:2.5,children:[de&&s.jsx(g,{name:"currentPassword",label:E("label.password"),type:L.value?"text":"password",InputProps:{endAdornment:s.jsx(T,{position:"end",children:s.jsx(D,{onClick:L.onToggle,edge:"end",children:s.jsx(x,{icon:L.value?"carbon:view":"carbon:view-off"})})})}}),ie==$.CHANGE_PASSWORD&&s.jsxs(s.Fragment,{children:[s.jsx(g,{name:"newPassword",label:E("label.new_password"),type:L.value?"text":"password",InputProps:{endAdornment:s.jsx(T,{position:"end",children:s.jsx(D,{onClick:L.onToggle,edge:"end",children:s.jsx(x,{icon:L.value?"carbon:view":"carbon:view-off"})})})}}),s.jsx(g,{name:"confirmNewPassword",label:E("label.confirm_new_password"),type:L.value?"text":"password",InputProps:{endAdornment:s.jsx(T,{position:"end",children:s.jsx(D,{onClick:L.onToggle,edge:"end",children:s.jsx(x,{icon:L.value?"carbon:view":"carbon:view-off"})})})}})]})]})]})}),s.jsxs(_,{spacing:1,direction:"row",children:[ie==$.NONE&&s.jsx(k,{color:"inherit",size:"large",variant:"contained",onClick:()=>se($.CHANGE_EMAIL),children:E("profile.change_email")}),ie==$.NONE&&s.jsx(k,{color:"inherit",size:"large",variant:"contained",onClick:()=>se($.CHANGE_PASSWORD),children:E("profile.change_password")}),de&&s.jsx(k,{color:"inherit",size:"large",variant:"contained",onClick:()=>se($.NONE),children:E("profile.cancel")}),s.jsx(k,{color:"inherit",size:"large",type:"submit",variant:"contained",loading:N,children:E("profile.save")})]})]}),s.jsx(M,{t:E,open:V,email:null==F?void 0:F.email,resend:ge,onClose:e=>{B(!1),e&&(ee(!0),setTimeout((()=>{ue()}),300)),se($.NONE),n.getUser({userId:z}).then((e=>{const r={firstName:e.firstName,lastName:e.lastName,email:e.email};U(e),he(r)}))}}),s.jsx(j,{open:Y,autoHideDuration:6e3,onClose:le,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:s.jsx(y,{onClose:le,severity:"success",variant:"filled",sx:{width:"100%"},children:E("email.email_changed")})})]})}));const R={verifyContainer:"_verifyContainer_rwmnr_1"};function M({t:e,open:r,email:n,resend:l,onClose:m}){const f=w("user"),g=i(t.useState(!1),2),j=g[0],y=g[1],v=c().shape({pin:d().min(6,`${e("email.code_characters")}`).required(`${e("email.code_required")}`)}),C={pin:""},P=p({mode:"onChange",resolver:u(v),defaultValues:C}),S=P.handleSubmit,O=P.setError,I=P.reset,q=S(function(){var r=a((function*(r){y(!0),f.confirmEmail(r).then((()=>{y(!1),m(!0),I(C)})).catch((r=>{y(!1),O("pin",{type:"manual",message:e(`processed_errors.${r.name}`)})}))}));return function(e){return r.apply(this,arguments)}}());return s.jsx(L,{open:r,"aria-labelledby":"email-verification-modal","aria-describedby":"email-verification-modal-description",children:s.jsx(o,{className:R.verifyContainer,children:s.jsxs(_,{sx:{textAlign:"center"},children:[s.jsx(N,{alt:"email inbox",src:"/ic_email_inbox.svg",sx:{mb:5,width:96,height:96,mx:"auto"}}),s.jsx(A,{variant:"h3",children:e("email.check")}),s.jsxs(A,{variant:"body2",sx:{mt:2,mb:5,color:"text.secondary"},children:[e("email.confirmation_code1")," ",n," ",e("email.confirmation_code2")]}),s.jsxs(h,{methods:P,onSubmit:q,children:[s.jsx(b,{name:"pin"}),s.jsx(k,{fullWidth:!0,size:"large",color:"inherit",type:"submit",variant:"contained",loading:j,sx:{mt:3},children:e("email.verify")})]}),s.jsxs(A,{variant:"body2",align:"center",sx:{mt:3},children:[e("email.dont_have_code"),s.jsxs(z,{variant:"subtitle2",onClick:()=>l(),underline:"none",sx:{cursor:"pointer"},children:[" ",e("email.resend_code")]})]}),s.jsxs(E,{onClick:()=>m(!1),color:"inherit",sx:{mt:3,mx:"auto",alignItems:"center",display:"inline-flex"},children:[s.jsx(x,{icon:"carbon:chevron-left",width:16,sx:{mr:1}}),e("action_btn.close")]})]})})})}const $={NONE:"",CHANGE_EMAIL:"CHANGE_EMAIL",CHANGE_PASSWORD:"CHANGE_PASSWORD"}}}}))}();
