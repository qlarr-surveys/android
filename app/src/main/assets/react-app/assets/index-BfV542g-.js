import{h as O,r as u,b as rt,_ as fe,d as Pe,j as e,q as be,B as y,s as nt,y as ot,A as Me}from"./index-vqe_o6H9.js";import{f as Ue,j as it,x as Re,c as lt,e as me,K as Se,I as A,T as k,bc as ue,M as se,R as ae,U as je,aL as G,Z as T,aN as pe,bd as ct,V as dt,aK as ut,aD as xe,aX as Ne,J as pt}from"./use-service-d2kt1S5h.js";import{u as He,d as mt,a as ht,D as vt}from"./Image-DgH_-1HC.js";import{s as ze,l as Ae}from"./DateUtils-Ce4EpQzP.js";import{b as B,g as gt,C as w,E as Le,S as ft,a as xt,A as _t,i as ee,d as yt,c as Ct,e as Ce,u as bt,F as St,R as jt,f as Dt,h as It,j as Fe}from"./Web-C9ZT8YVq.js";import{d as Tt}from"./dayjs.min-DYKOtYve.js";import{d as kt}from"./Delete-mLsNk6qT.js";import{b as Et}from"./common-BD7EYaWJ.js";import{T as Ve}from"./TextField-C6oYyR3a.js";import{C as We}from"./Check-DYdR5qL2.js";import{C as Ge}from"./Card-CpAAQw08.js";import{C as Ot,a as Be}from"./Close-CWD1l4TR.js";import{D as $t}from"./Divider-CIcj_-7z.js";import{c as Pt,a as Rt,o as Nt,L as zt}from"./yup-_RuJkQjn.js";import{S as L}from"./survey-D2pw4t3m.js";import{T as At}from"./TablePagination-BWS_Lcm8.js";import"./Checkbox-DhL0zY9B.js";import"./SwitchBase-Dz0Guboj.js";import"./Tabs-Tuo9qr73.js";import"./radioClasses-CQtWv4A0.js";import"./tableRowClasses-DQPZ0xYH.js";import"./FormControlLabel-BRqqeCMk.js";import"./TableCell-CjHiMFsD.js";import"./Toolbar-ZGLOM2Zn.js";function Ft(t){const{badgeContent:s,invisible:a=!1,max:c=99,showZero:d=!1}=t,l=He({badgeContent:s,max:c});let n=a;a===!1&&s===0&&!d&&(n=!0);const{badgeContent:o,max:i=c}=n?l:t,h=o&&Number(o)>i?"".concat(i,"+"):o;return{badgeContent:o,invisible:n,max:i,displayValue:h}}const Bt=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],_e=10,ye=4,wt=t=>{const{color:s,anchorOrigin:a,invisible:c,overlap:d,variant:l,classes:n={}}=t,o={root:["root"],badge:["badge",l,c&&"invisible","anchorOrigin".concat(O(a.vertical)).concat(O(a.horizontal)),"anchorOrigin".concat(O(a.vertical)).concat(O(a.horizontal)).concat(O(d)),"overlap".concat(O(d)),s!=="default"&&"color".concat(O(s))]};return lt(o,gt,n)},Mt=Ue("span",{name:"MuiBadge",slot:"Root",overridesResolver:(t,s)=>s.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Ut=Ue("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.badge,s[a.variant],s["anchorOrigin".concat(O(a.anchorOrigin.vertical)).concat(O(a.anchorOrigin.horizontal)).concat(O(a.overlap))],a.color!=="default"&&s["color".concat(O(a.color))],a.invisible&&s.invisible]}})(({theme:t})=>{var s;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:_e*2,lineHeight:1,padding:"0 6px",height:_e*2,borderRadius:_e,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys(((s=t.vars)!=null?s:t).palette).filter(a=>{var c,d;return((c=t.vars)!=null?c:t).palette[a].main&&((d=t.vars)!=null?d:t).palette[a].contrastText}).map(a=>({props:{color:a},style:{backgroundColor:(t.vars||t).palette[a].main,color:(t.vars||t).palette[a].contrastText}})),{props:{variant:"dot"},style:{borderRadius:ye,height:ye*2,minWidth:ye*2,padding:0}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(B.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}}),we=u.forwardRef(function(s,a){var c,d,l,n,o,i;const h=it({props:s,name:"MuiBadge"}),{anchorOrigin:C={vertical:"top",horizontal:"right"},className:x,component:v,components:g={},componentsProps:D={},children:M,overlap:V="rectangular",color:b="default",invisible:_=!1,max:Y=99,badgeContent:F,slots:$,slotProps:P,showZero:f=!1,variant:j="standard"}=h,R=rt(h,Bt),{badgeContent:N,invisible:U,max:re,displayValue:he}=Ft({max:Y,invisible:_,badgeContent:F,showZero:f}),H=He({anchorOrigin:C,color:b,overlap:V,variant:j,badgeContent:F}),ne=U||N==null&&j!=="dot",{color:oe=b,overlap:q=V,anchorOrigin:ie=C,variant:W=j}=ne?H:h,X=W!=="dot"?he:void 0,Q=fe({},h,{badgeContent:N,invisible:ne,max:re,displayValue:X,showZero:f,anchorOrigin:ie,color:oe,overlap:q,variant:W}),K=wt(Q),le=(c=(d=$==null?void 0:$.root)!=null?d:g.Root)!=null?c:Mt,ce=(l=(n=$==null?void 0:$.badge)!=null?n:g.Badge)!=null?l:Ut,Z=(o=P==null?void 0:P.root)!=null?o:D.root,J=(i=P==null?void 0:P.badge)!=null?i:D.badge,ve=Re({elementType:le,externalSlotProps:Z,externalForwardedProps:R,additionalProps:{ref:a,as:v},ownerState:Q,className:Pe(Z==null?void 0:Z.className,K.root,x)}),ge=Re({elementType:ce,externalSlotProps:J,ownerState:Q,className:Pe(K.badge,J==null?void 0:J.className)});return e.jsxs(le,fe({},ve,{children:[M,e.jsx(ce,fe({},ge,{children:X}))]}))}),Ht=me(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),Lt=me(e.jsx("path",{d:"M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H9V4h9zM3 15v-2h2v2zm0-5.5h2v2H3zM10 20h2v2h-2zm-7-1.5v-2h2v2zM5 22c-1.1 0-2-.9-2-2h2zm3.5 0h-2v-2h2zm5 0v-2h2c0 1.1-.9 2-2 2M5 6v2H3c0-1.1.9-2 2-2"}),"CopyAll"),Vt=me(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),Wt=me(e.jsx("path",{d:"M6 6h12v12H6z"}),"Stop"),Gt="_mainContainer_1kl2v_1",Yt="_newSurveysButton_1kl2v_8",qt="_content_1kl2v_13",Xt="_loadingWrapper_1kl2v_20",Qt="_allButton_1kl2v_27",Kt="_surveyCardsContainer_1kl2v_43",Zt="_noSurveys_1kl2v_51",te={mainContainer:Gt,newSurveysButton:Yt,content:qt,loadingWrapper:Xt,allButton:Qt,surveyCardsContainer:Kt,noSurveys:Zt};var De={},Jt=be;Object.defineProperty(De,"__esModule",{value:!0});var Ye=De.default=void 0,ea=Jt(Se()),ta=e;Ye=De.default=(0,ea.default)((0,ta.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Article");const aa="_surveyHeader_k7hfg_1",sa="_contentCard_k7hfg_7",ra="_actionBtn_k7hfg_11",na="_card_k7hfg_17",oa="_cardContent_k7hfg_22",ia="_imageContainer_k7hfg_28",la="_surveyContent_k7hfg_35",ca="_surveyTitle_k7hfg_43",da="_surveyStatus_k7hfg_48",ua="_badge_k7hfg_55",pa="_textTransform_k7hfg_61",ma="_surveyResponse_k7hfg_65",ha="_surveyActions_k7hfg_72",va="_iconButton_k7hfg_82",ga="_logo_k7hfg_126",fa="_logoImageWrapper_k7hfg_139",xa="_imageOverlay_k7hfg_143",_a="_cameraIconWrapper_k7hfg_155",ya="_cameraIcon_k7hfg_155",Ca="_relativeContainer_k7hfg_182",ba="_absoluteOverlay_k7hfg_187",Sa="_container_k7hfg_200",ja="_truncatedText_k7hfg_206",Da="_exampleTruncatedText_k7hfg_220",Ia="_titleContainer_k7hfg_235",Ta="_surveyLink_k7hfg_243",ka="_nameIcon_k7hfg_248",Ea="_descriptionContainer_k7hfg_259",Oa="_descriptionIcon_k7hfg_272",$a="_photoIcon_k7hfg_281",p={surveyHeader:aa,contentCard:sa,actionBtn:ra,card:na,cardContent:oa,imageContainer:ia,surveyContent:la,surveyTitle:ca,surveyStatus:da,badge:ua,textTransform:pa,surveyResponse:ma,surveyActions:ha,iconButton:va,logo:ga,logoImageWrapper:fa,imageOverlay:xa,cameraIconWrapper:_a,cameraIcon:ya,relativeContainer:Ca,absoluteOverlay:ba,container:Sa,truncatedText:ja,exampleTruncatedText:Da,titleContainer:Ia,surveyLink:Ta,nameIcon:ka,descriptionContainer:Ea,descriptionIcon:Oa,photoIcon:$a};function de(t,s){return t?Tt(t).format("DD MMM YYYY"):""}var Ie={},Pa=be;Object.defineProperty(Ie,"__esModule",{value:!0});var qe=Ie.default=void 0,Ra=Pa(Se()),Na=e;qe=Ie.default=(0,Ra.default)((0,Na.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"}),"FormatQuote");var Te={},za=be;Object.defineProperty(Te,"__esModule",{value:!0});var Xe=Te.default=void 0,Aa=za(Se()),Fa=e;Xe=Te.default=(0,Aa.default)((0,Fa.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning");const Ba=({survey:t,onSave:s,isEditable:a=!0})=>{const[c,d]=u.useState(!1),[l,n]=u.useState(t.name),o=x=>{const v=x.target.value;v.length<=50&&n(v)},i=()=>{l.trim()===""?n(t.name):l!==t.name&&s(l,()=>n(t.name)),d(!1)},h=x=>{x.key==="Enter"&&i()},C=x=>{x.stopPropagation(),d(!0)};return e.jsx(y,{className:p.titleContainer,children:c?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{sx:{px:3,flexGrow:1},value:l,onChange:o,onKeyDown:h,autoFocus:!0,variant:"standard",fullWidth:!0,InputProps:{style:{color:"white"}}}),e.jsx(A,{className:p.saveIcon,onClick:i,sx:{ml:1},children:e.jsx(We,{sx:{color:"white"}})})]}):e.jsxs(e.Fragment,{children:[l.length>20?e.jsx(w,{title:l,showIcon:!1,children:e.jsx(k,{variant:"h4",sx:{px:3},noWrap:!0,children:ue(l,18)})}):e.jsx(k,{variant:"h4",sx:{px:3},noWrap:!0,children:ue(l,18)}),a&&e.jsx(A,{className:p.nameIcon,onClick:C,sx:{ml:1},children:e.jsx(Le,{sx:{color:"white"}})})]})})},wa=({survey:t,onSave:s,isEditable:a=!0,isExample:c})=>{const[d,l]=u.useState(!1),[n,o]=u.useState(t.description),i=c?450:125,h=g=>{o(g.target.value)},C=()=>{n!==t.description&&s(n,()=>o(t.description)),l(!1)},x=g=>{g.key==="Enter"&&C()},v=g=>{g.stopPropagation(),l(!0)};return e.jsx(y,{className:p.descriptionContainer,children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{sx:{px:3},value:n,onChange:h,onKeyDown:x,autoFocus:!0,variant:"standard",fullWidth:!0,multiline:!0,rows:3}),e.jsx(A,{className:"".concat(p.saveIcon),onClick:C,sx:{ml:1},children:e.jsx(We,{sx:{color:"gray"}})})]}):e.jsxs(e.Fragment,{children:[(n==null?void 0:n.length)>i?e.jsx(w,{title:n,showIcon:!1,children:e.jsx(k,{variant:"caption",sx:{px:3,color:n?"inherit":"gray",flexGrow:1},className:"".concat(c?p.exampleTruncatedText:p.truncatedText),children:ue(n,i)||"Click to add a description..."})}):e.jsx(k,{variant:"caption",sx:{px:3,color:n?"inherit":"gray",flexGrow:1},className:"".concat(c?p.exampleTruncatedText:p.truncatedText),children:ue(n,i)||"Click to add a description..."}),a&&e.jsx(A,{className:"".concat(p.descriptionIcon),onClick:v,sx:{ml:1},children:e.jsx(Le,{sx:{color:"gray"}})})]})})},m={DRAFT:"draft",CLOSED:"closed",ACTIVE:"active",EXPIRED:"expired",SCHEDULED:"scheduled"},Ma=t=>{switch(t.status){case"draft":return m.DRAFT;case"closed":return m.CLOSED;case"active":return t.endDate&&ze(t.endDate)<Date.now()?m.EXPIRED:t.startDate&&ze(t.startDate)>Date.now()?m.SCHEDULED:m.ACTIVE;default:return m.DRAFT}},Ua=t=>{switch(t){case m.DRAFT:return"#e9db3e";case m.CLOSED:return"#d32f2f";case m.EXPIRED:return"#9d4435";case m.SCHEDULED:return"#607d8b";case m.ACTIVE:return"#669834";default:return}},Qe=({survey:t,example:s=!1,onClone:a,onDelete:c,onClose:d,onUpdateTitle:l,onUpdateDescription:n,onUpdateImage:o})=>{const{t:i}=se("manage"),h=Ma(t),C=ae("survey"),x=ae("design"),[v,g]=u.useState(!1),[D,M]=u.useState(null),V=nt(),b=je(),_=ot(),Y=(f,j)=>{b(T(!0)),C.putSurvey({...t,name:f},t.id).then(()=>{l(t.id,f)}).catch(R=>{R.name==pe.DUPLICATE_SURVEY_NAME.name&&(M(i("processed_errors.".concat(R.name))),g(!0),j())}).finally(()=>{b(T(!1))})},F=f=>{b(T(!0)),C.putSurvey({...t,description:f},t.id).then(()=>{n(t.id,f)}).catch(j=>{}).finally(()=>{b(T(!1))})},$=()=>{g(!1)},P=f=>{const j=f.target.files[0],R=new FileReader;R.onload=()=>{x.uploadResource(j,t.id).then(N=>{C.putSurvey({image:N.name},t.id).then(U=>{o(t.id,N.name)}).catch(U=>{M(i("processed_errors.".concat(U.name))),g(!0)}).finally(()=>{b(T(!1))})}).catch(N=>{M(i("processed_errors.".concat(N.name))),g(!0)}).finally(()=>{b(T(!1))})},R.readAsDataURL(j)};return e.jsxs(e.Fragment,{children:[e.jsx(ft,{}),e.jsx(xt,{open:v,autoHideDuration:6e3,onClose:$,children:e.jsx(_t,{onClose:$,severity:"error",children:D})}),e.jsxs(Ge,{sx:{"&:hover":{boxShadow:f=>f.customShadows.z24}},children:[e.jsxs(G,{sx:{pb:0},children:[e.jsxs(G,{spacing:.5,sx:{mb:1},children:[e.jsxs(y,{className:p.relativeContainer,children:[e.jsx(y,{className:p.absoluteOverlay,children:e.jsx(Ba,{survey:t,onSave:Y,isEditable:ee()&&!s})}),e.jsxs(y,{className:p.logo,children:[e.jsxs(y,{className:"".concat(p.logoImageWrapper),children:[e.jsx(Ot,{component:"img",image:t.image?Et(t.image,t.id,s):"/qlarr.png",height:"150"}),e.jsx(y,{className:p.imageOverlay}),ee()&&!t.example&&e.jsx(y,{className:p.photoIcon,onClick:f=>{f.stopPropagation(),document.getElementById("imageInput-".concat(t.id)).click()},children:e.jsx(mt,{className:p.cameraIcon})})]}),e.jsx("input",{id:"imageInput-".concat(t.id),type:"file",accept:"image/*",style:{display:"none"},onChange:P})]})]}),e.jsx(wa,{survey:t,isExample:s,onSave:F,isEditable:ee()&&!s}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs(G,{direction:"row",alignItems:"center",spacing:.5,sx:{px:3,typography:"body2",color:"text.secondary"},children:[e.jsx("span",{style:{backgroundColor:Ua(h)},className:p.badge})," ",e.jsx(k,{variant:"subtitle2",className:p.textTransform,children:i("status.".concat(h))})]}),e.jsxs(y,{sx:{px:3,display:"flex",gap:2,my:.5},children:[!s&&t.status!=="closed"&&t.latestVersion.published===!1&&e.jsx(w,{title:"Has unpublished changes",showIcon:!1,children:e.jsx(Xe,{sx:{color:"text.secondary"}})}),e.jsx(w,{showIcon:!1,title:"Complete Responses: ".concat(t.completeResponseCount),children:e.jsx(we,{badgeContent:t.completeResponseCount,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(yt,{sx:{color:"text.secondary"}})})}),e.jsx(w,{showIcon:!1,title:t.surveyQuota>0?"Quota: ".concat(t.surveyQuota):"No Quota",children:e.jsx(we,{badgeContent:t.surveyQuota>0?t.surveyQuota:0,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(qe,{sx:{color:"text.secondary"}})})})]})]})]}),e.jsxs(k,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:i("edit_survey.metadata.created")}),":"," ",de(t.creationDate)]}),e.jsxs(k,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:i("edit_survey.metadata.last_modified")}),":"," ",de(t.lastModified)]}),!s&&t.startDate&&e.jsxs(k,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:i("edit_survey.metadata.start_date")}),":"," ",de(t.startDate)]}),!s&&t.endDate&&e.jsxs(k,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:i("edit_survey.metadata.end_date")}),":"," ",de(t.endDate)]})]}),e.jsx($t,{sx:{borderStyle:"dashed",my:1}}),e.jsxs(G,{sx:{p:3,pt:0,typography:"body2",color:"text.secondary",textTransform:"capitalize"},className:p.surveyActions,children:[e.jsx(A,{className:p.iconButton,sx:{backgroundColor:_.palette.primary.main,"&:hover":{backgroundColor:_.palette.primary.main}},"aria-label":"redirect",size:"large",onClick:f=>{f.stopPropagation();const j=t.example?"/guest/preview/".concat(t.id):"/design-survey/".concat(t.id);V(j)},children:s?e.jsx(ht,{sx:{color:"#fff"}}):e.jsx(Ye,{sx:{color:"#fff"}})}),ee()&&!s&&t.status==="active"&&e.jsx(w,{showIcon:!1,title:i("edit_survey.close_title"),children:e.jsx(A,{className:p.iconButton,"aria-label":"stop",size:"large",onClick:()=>d(t.id),children:e.jsx(Wt,{color:"primary"})})}),ee()&&e.jsx(w,{showIcon:!1,title:i("edit_survey.clone_survey"),children:e.jsx(A,{className:p.iconButton,"aria-label":"clone",size:"large",onClick:a,children:e.jsx(Ct,{color:"primary"})})}),!s&&t.status!==m.ACTIVE&&e.jsx(w,{showIcon:!1,title:i("action_btn.delete"),children:e.jsx(A,{className:p.iconButton,"aria-label":"delete",size:"large",onClick:()=>c(t.id),children:e.jsx(kt,{color:"primary"})})})]})]})]})},Ha=({sort:t,filter:s,onFilterSelected:a,onSortSelected:c})=>{const d=[{value:"responses_desc",label:"survey_sort_options.responses_desc"},{value:"last_modified_desc",label:"survey_sort_options.last_modified_desc"}],l=[{value:"all",label:"status.all"},{value:m.ACTIVE,label:"status.".concat(m.ACTIVE)},{value:m.SCHEDULED,label:"status.".concat(m.SCHEDULED)},{value:m.DRAFT,label:"status.".concat(m.DRAFT)},{value:m.EXPIRED,label:"status.".concat(m.EXPIRED)},{value:m.CLOSED,label:"status.".concat(m.CLOSED)}],{t:n}=se("manage");return e.jsxs(y,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(k,{variant:"h5",flex:"1",textTransform:"uppercase",fontWeight:"600",children:n("my_surveys")}),e.jsxs(G,{width:"100%",spacing:2.5,direction:{xs:"column",md:"row"},alignItems:"center",children:[e.jsx(Ce,{onChange:c,native:!0,value:t,name:"Status",label:n("label.sort_by"),children:d.map(o=>e.jsx("option",{value:o.value,children:n(o.label)},o.value))}),e.jsx(Ce,{onChange:a,native:!0,value:s,name:"Status",label:n("edit_survey.status"),children:l.map(o=>e.jsx("option",{value:o.value,children:n(o.label)},o.value))})]})]})},La="_exampleSurveysContainer_apkeh_1",Va={exampleSurveysContainer:La},Wa=({onClone:t})=>{const{t:s}=se("manage"),[a,c]=u.useState(!1),[d,l]=u.useState([]),n=ae("survey");return u.useEffect(()=>{c(!0),n.getGuestsSurveys().then(o=>{if(c(!1),o){const i=o.map(h=>({...h,example:!0}));l(i)}}).catch(o=>{c(!1),ct(o)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"h5",marginBottom:2,fontWeight:600,textTransform:"uppercase",children:s("example_surveys")}),a?e.jsx(Me,{}):e.jsx(y,{className:Va.exampleSurveysContainer,sx:{mt:3,columnGap:4,display:"grid",rowGap:{xs:4,md:5},gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:d==null?void 0:d.map(o=>e.jsx(Qe,{survey:o,onClone:()=>t(o),example:!0},o.id))})]})},Ga="_createUserCard_zrfc2_1",Ya="_formGroup_zrfc2_9",qa="_rightContainer_zrfc2_16",Xa="_createButton_zrfc2_24",Qa="_surveyNameInput_zrfc2_39",Ka="_selectInput_zrfc2_55",Za="_errorText_zrfc2_63",Ja={createUserCard:Ga,formGroup:Ya,rightContainer:qa,createButton:Xa,surveyNameInput:Qa,selectInput:Ka,errorText:Za},es=[{value:L.WEB,label:"mode.".concat(L.WEB)},{value:L.OFFLINE,label:"mode.".concat(L.OFFLINE)},{value:L.MIXED,label:"mode.".concat(L.MIXED)}];function ts({onSurveyCreated:t}){const s=ae("survey"),{t:a}=se("manage"),c=je(),d={surveyName:"",surveyMode:L.MIXED,surveyActiveFrom:"",surveyActiveTo:""},l=Pt().shape({surveyName:Rt().required(a("survey_required")).max(50,a("survey_too_long"))}),n=bt({resolver:Nt(l),defaultValues:d}),{setError:o,reset:i,handleSubmit:h,formState:{isSubmitting:C}}=n,x=h(async v=>{c(T(!0));const g={name:v.surveyName,usage:v.surveyMode};v.surveyActiveFrom&&(g.startDate=Ae(surveyActiveFrom)),v.surveyActiveTo&&(g.endDate=Ae(surveyActiveTo)),s.createSurvey(g).then(()=>{t&&(t(),i())}).catch(D=>{D.name==pe.DUPLICATE_SURVEY_NAME.name?o("surveyName",{type:"manual",message:a("processed_errors.".concat(D.name))}):D.name==pe.INVALID_SURVEY_DATES.name&&o("surveyActiveFrom",{type:"manual",message:a("processed_errors.".concat(D.name))})}).finally(()=>{c(T(!1))})});return e.jsx(Ge,{className:Ja.createUserCard,children:e.jsx(St,{methods:n,onSubmit:x,children:e.jsxs(y,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(3, 1fr)"},children:[e.jsx(jt,{name:"surveyName",label:a("label.survey_name")}),e.jsx(Ce,{name:"surveyMode",label:a("label.survey_mode"),children:es.map(v=>e.jsx("option",{value:v.value,children:a(v.label)},v.value))}),e.jsx(zt,{fullWidth:!0,size:"large",color:"primary",type:"submit",variant:"contained",loading:C,children:a("action_btn.create")})]})})})}function Is(){var Oe,$e;const t=ae("survey"),[s,a]=u.useState(null),[c,d]=u.useState(!0),[l,n]=u.useState(1),[o,i]=u.useState(5),[h,C]=u.useState("all"),[x,v]=u.useState("last_modified_desc"),[g,D]=u.useState(!1),[M,V]=u.useState(),b=je(),{t:_}=se("manage"),Y=r=>{d(!1)},F=()=>{t.getAllSurveys(l,o,h,x).then(r=>{r&&(d(!1),a(r))}).catch(r=>Y())};u.useEffect(()=>{F()},[l,o,x,h]);const $=(r,S)=>{a(I=>({...I,surveys:I.surveys.map(z=>z.id===r?{...z,status:S}:z)}))},P=()=>{const r=pt.getUser().roles;return r.indexOf(Fe.SUPER_ADMIN)>-1||r.indexOf(Fe.SURVEY_ADMIN)>-1},[f,j]=u.useState(""),[R,N]=u.useState(""),[U,re]=u.useState(null),[he,H]=u.useState(!1),[ne,oe]=u.useState(_("action_btn.delete")),[q,ie]=u.useState(!1),[W,X]=u.useState(!1),[Q,K]=u.useState(!1),le=()=>{ie(!0)},ce=()=>{X(!0)},Z=()=>{K(!0),D(!0)},J=()=>{ie(!1)},ve=()=>{X(!1)},ge=r=>{N("delete"),oe(_("action_btn.delete")),re(r),j(_("edit_survey.delete_survey",{survey_name:r.name})),H(!0)},Ke=r=>{N("close"),oe(_("action_btn.close")),re(r),j(_("edit_survey.close_survey",{survey_name:r.name})),H(!0)},Ze=()=>{R==="delete"?(Je(U.id),H(!1)):R==="close"&&(et(U.id),H(!1))},ke=r=>{V(r),D(!0)},Je=r=>{b(T(!0)),t.deleteSurvey(r).then(()=>{F()}).catch(S=>{b(T(!1))}).finally(()=>{b(T(!1))})},et=r=>{b(T(!0)),t.closeSurvey(r).then(S=>{$(r,"closed")}).catch(S=>{S.name==pe.INVALID_SURVEY_DATES.name&&setSurveyDateError(_("processed_errors.".concat(processed.name)))}).finally(()=>{b(T(!1))})},tt=(r,S)=>{a(I=>{const z=I.surveys.map(E=>E.id===r?{...E,name:S}:E);return{...I,surveys:z}})},at=(r,S)=>{a(I=>{const z=I.surveys.map(E=>E.id===r?{...E,description:S}:E);return{...I,surveys:z}})},st=(r,S)=>{a(I=>{const z=I.surveys.map(E=>E.id===r?{...E,image:S}:E);return{...I,surveys:z}})},Ee=dt();return e.jsxs(y,{className:te.mainContainer,children:[e.jsx(ut,{children:e.jsxs(y,{className:te.content,children:[e.jsxs(G,{className:te.newSurveysButton,direction:"row",spacing:2,children:[P()&&!q&&e.jsx(xe,{variant:"contained",color:"primary",startIcon:e.jsx(Ht,{}),onClick:le,children:_("create_new_survey")}),P()&&!W&&e.jsx(xe,{variant:"contained",color:"primary",startIcon:e.jsx(Lt,{}),onClick:ce,children:_("copy_example_surveys")}),P()&&e.jsx(xe,{variant:"contained",color:"primary",startIcon:e.jsx(Dt,{}),onClick:Z,children:_("import_survey")})]}),q&&e.jsx(Ne,{in:q,timeout:300,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(A,{onClick:J,"aria-label":"close",style:{position:"absolute",top:0,...Ee==="ltr"?{right:0}:{left:0},color:"black",zIndex:1},children:e.jsx(Be,{color:"#000"})}),e.jsx(ts,{onSurveyCreated:F})]})}),W&&e.jsx(Ne,{in:W,timeout:300,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(A,{onClick:ve,"aria-label":"close",style:{position:"absolute",top:0,...Ee==="ltr"?{right:0}:{left:0},color:"black",zIndex:1},children:e.jsx(Be,{color:"#000"})}),e.jsx(Wa,{onClone:r=>ke(r)})]})}),e.jsx(Ha,{filter:h,onFilterSelected:r=>{n(1),C(r.target.value)},sort:x,onSortSelected:r=>{n(1),v(r.target.value)}}),e.jsx(y,{className:te.surveyCardsContainer,children:c?e.jsx(Me,{}):e.jsx(e.Fragment,{children:((Oe=s==null?void 0:s.surveys)==null?void 0:Oe.length)>0?e.jsx(y,{sx:{mt:3,columnGap:2,display:"grid",rowGap:{xs:4,md:5},gridTemplateColumns:{xs:"1fr",sm:"repeat(auto-fit, minmax(280px, 1fr))",md:"repeat(auto-fit, minmax(330px, 350px))"}},children:($e=s==null?void 0:s.surveys)==null?void 0:$e.map(r=>e.jsx(Qe,{survey:r,onStatusChange:$,onClone:()=>ke(r),onDelete:()=>ge(r),onClose:()=>Ke(r),onUpdateTitle:tt,onUpdateDescription:at,onUpdateImage:st},r.id))}):e.jsxs("div",{className:te.noSurveys,children:[e.jsx(Vt,{sx:{fontSize:48,color:"#ccc"}}),e.jsx(k,{variant:"h6",color:"textSecondary",sx:{mt:2},children:_("create_survey.empty_state_message")})]})})}),s&&e.jsx(At,{rowsPerPageOptions:[5,10,20,50],component:"div",labelDisplayedRows:({from:r,to:S,count:I,page:z})=>_("responses.label_displayed_rows",{from:r,to:S,count:I}),labelRowsPerPage:_("responses.label_surveys_per_page"),count:s==null?void 0:s.totalCount,rowsPerPage:o,page:l-1,onPageChange:(r,S)=>{n(S+1)},onRowsPerPageChange:r=>{i(parseInt(r.target.value,10)),n(1)}})]})}),e.jsx(It,{importSurvey:Q,open:g,onClose:r=>{D(!1),K(!1),r&&F()},survey:M}),e.jsx(vt,{open:he,description:f,handleClose:()=>H(!1),handleDelete:Ze,title:ne})]})}export{Is as default};
