!function(){function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,s,i,l=[],o=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;o=!1}else for(;!(o=(a=s.call(r)).done)&&(l.push(a.value),l.length!==t);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return l}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function r(e,t,r,a,n,s,i){try{var l=e[s](i),o=l.value}catch(e){return void r(e)}l.done?t(o):Promise.resolve(o).then(a,n)}System.register(["./index-legacy-z8WAiyjY.js","./use-service-legacy-DoYgXERf.js","./yup-legacy-Bqdsra_v.js","./Web-legacy-Dz-SFdTk.js","./Tabs-legacy-NAzkEbva.js","./Card-legacy-CChnSgv3.js","./TableRow-legacy-Nu651E_a.js","./tableRowClasses-legacy-DaFKeYPP.js","./TableHead-legacy-7BBQ8TBy.js","./TableCell-legacy-BCalByND.js","./Divider-legacy-DSbk0vHb.js","./Checkbox-legacy-BaYVgtdy.js","./SwitchBase-legacy-B0lowptr.js","./radioClasses-legacy-BlR7uqLF.js","./TextField-legacy-D6Q451tj.js","./FormControlLabel-legacy-nx1jJyxs.js"],(function(t,a){"use strict";var n,s,i,l,o,c,d,u,m,h,p,x,f,_,g,j,v,b,y,C,S,N,w,I,A,U,R,D,M,E,k,T,L,$,q,V,z,P,B,O,W,Y,F,H,Z,G,J,K,Q,X,ee;return{setters:[e=>{n=e.j,s=e.f,i=e.g,l=e.h,o=e._,c=e.r,d=e.b,u=e.d,m=e.B,h=e.R},e=>{p=e.e,x=e.f,f=e.B,_=e.j,g=e.c,j=e.M,v=e.aM,b=e.T,y=e.aD,C=e.R,S=e.U,N=e.Z,w=e.aN,I=e.aL,A=e.J,U=e.I,R=e.bV,D=e.N},e=>{M=e.L,E=e.d,k=e.a,T=e.c,L=e.e,$=e.o},e=>{q=e.u,V=e.p,z=e.j,P=e.F,B=e.R,O=e.q,W=e.I},e=>{Y=e.a},e=>{F=e.C},e=>{H=e.T,Z=e.a,G=e.b,J=e.c},e=>{K=e.a},e=>{Q=e.T},e=>{X=e.T},e=>{ee=e.D},null,null,null,null,null],execute:function(){var a=document.createElement("style");a.textContent="._mainContainer_1u62w_1{margin:auto;max-width:800px;min-width:300px;height:calc(100vh - 64px);overflow:auto}._content_1u62w_9{margin-top:30px}._addUser_6nyqh_1{display:flex;gap:10px;margin-top:20px;align-items:center}._wrapper_1rjvu_1{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;box-shadow:0 0 20px rgba(0,0,0,.1);border-radius:8px;padding:2rem;min-width:500px}._action_1rjvu_13{display:flex;align-items:center;gap:1rem;justify-content:flex-end;margin-top:30px}._mainContainer_sp6mp_1{margin:auto;max-width:800px;min-width:300px;height:calc(100vh - 64px);overflow:auto}._createUserCard_sp6mp_9{padding:25px}._formGroup_sp6mp_13{max-width:400px}._errorText_sp6mp_17{color:#eb5757!important}\n/*$vite$:1*/",document.head.appendChild(a),t("default",(function(){return n.jsx(m,{className:ce.mainContainer,children:n.jsx(fe,{})})}));const te=p(n.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");function re(e){return i("MuiTableSortLabel",e)}const ae=s("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc"]),ne=["active","children","className","direction","hideSortIcon","IconComponent"],se=x(f,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,t)=>{const r=e.ownerState;return[t.root,r.active&&t.active]}})((({theme:e})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(e.vars||e).palette.text.secondary},"&:hover":{color:(e.vars||e).palette.text.secondary,[`& .${ae.icon}`]:{opacity:.5}},[`&.${ae.active}`]:{color:(e.vars||e).palette.text.primary,[`& .${ae.icon}`]:{opacity:1,color:(e.vars||e).palette.text.secondary}}}))),ie=x("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,t)=>{const r=e.ownerState;return[t.icon,t[`iconDirection${l(r.direction)}`]]}})((({theme:e,ownerState:t})=>o({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none"},"desc"===t.direction&&{transform:"rotate(0deg)"},"asc"===t.direction&&{transform:"rotate(180deg)"}))),le=c.forwardRef((function(e,t){const r=_({props:e,name:"MuiTableSortLabel"}),a=r.active,s=void 0!==a&&a,i=r.children,c=r.className,m=r.direction,h=void 0===m?"asc":m,p=r.hideSortIcon,x=void 0!==p&&p,f=r.IconComponent,j=void 0===f?te:f,v=d(r,ne),b=o({},r,{active:s,direction:h,hideSortIcon:x,IconComponent:j}),y=(e=>{const t=e.classes,r=e.direction,a={root:["root",e.active&&"active"],icon:["icon",`iconDirection${l(r)}`]};return g(a,re,t)})(b);return n.jsxs(se,o({className:u(y.root,c),component:"span",disableRipple:!0,ownerState:b,ref:t},v,{children:[i,x&&!s?null:n.jsx(ie,{as:j,className:u(y.icon),ownerState:b})]}))})),oe=p(n.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd"),ce={mainContainer:"_mainContainer_1u62w_1",content:"_content_1u62w_9"},de="_addUser_6nyqh_1",ue="_wrapper_1rjvu_1",me="_action_1rjvu_13",he=({open:e,onClose:t,deleteUser:r,name:a,isLoading:s})=>{const i=j("manage").t;return n.jsx(v,{sx:{".MuiBackdrop-root":{backgroundColor:"rgba(0, 0, 0, 0.3)"}},open:e,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs(m,{className:ue,children:[n.jsx(b,{children:i("users_manage.delete_title",{name:a})}),n.jsxs(m,{className:me,children:[n.jsx(M,{variant:"contained",onClick:r,loading:s,children:i("action_btn.delete")}),n.jsx(y,{onClick:t,children:i("action_btn.cancel")})]})]})})},pe="_createUserCard_sp6mp_9";function xe({userId:e,open:t,onClose:a}){const s=C("user"),i=j("manage").t,l=S();E(k,"noWhitespace",(function(e){return this.test("no-whitespace",e,(function(t){const r=this.path,a=this.createError;return!(null==t||!t.trim())||a({path:r,message:e})}))}));const o=T().shape({firstName:k().required(i("firstname_required")).noWhitespace(i("error.invalid_first_name")).max(50,i("error.first_name_too_long")),lastName:k().required(i("lastname_required")).noWhitespace(i("error.invalid_last_name")).max(50,i("error.last_name_too_long")),email:k().required(i("email_required")).matches(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/i,i("error.invalid_email")),roles:L().required(i("error.roles_required")).min(1,i("error.at_least_one_role"))}),d=q({resolver:$(o),defaultValues:{firstName:"",lastName:"",email:"",roles:[]}}),u=V({control:d.control,name:"roles"}),h=d.setError,p=d.reset,x=d.handleSubmit,f=d.formState.isSubmitting,_=d.setValue;d.watch;c.useEffect((()=>{e&&(l(N(!0)),s.getUser({userId:e}).then((e=>{l(N(!1)),p(e)})))}),[p,e]);const g=x(function(){var t,n=(t=function*(t){l(N(!0));const r=t.firstName,n=t.lastName,o=t.email,c=t.roles;try{e?yield s.updateUser({userId:e,data:{email:o,firstName:r,lastName:n,roles:c}}):yield s.createUser({email:o,firstName:r,lastName:n,roles:c}),a()}catch(d){d.name==w.DUPLICATE_EMAIL.name&&h("email",{type:"manual",message:i(`processed_errors.${d.name}`)})}finally{l(N(!1))}},function(){var e=this,a=arguments;return new Promise((function(n,s){var i=t.apply(e,a);function l(e){r(i,n,s,l,o,"next",e)}function o(e){r(i,n,s,l,o,"throw",e)}l(void 0)}))});return function(e){return n.apply(this,arguments)}}()),v=[{value:z.SUPER_ADMIN,label:i("label.super_admin")},{value:z.SURVEY_ADMIN,label:i("label.survey_admin")},{value:z.ANALYST,label:i("label.analyst")},{value:z.SURVEYOR,label:i("label.surveyor")}];return c.useEffect((()=>{const e=u.includes(z.SUPER_ADMIN),t=u.includes(z.SURVEY_ADMIN);if(e||t){const e=u.filter((e=>e===z.SUPER_ADMIN||e===z.SURVEY_ADMIN));_("roles",e)}}),[u,_]),n.jsx(Y,{open:t,onClose:a,maxWidth:"md",fullWidth:!0,children:n.jsxs(F,{sx:{overflow:"visible"},className:pe,children:[n.jsx(b,{variant:"h4",sx:{mb:3},children:i(e?"edit_user.title":"add_user.title")}),n.jsxs(P,{methods:d,onSubmit:g,children:[n.jsxs(I,{spacing:2.5,children:[n.jsx(B,{name:"firstName",label:i("label.first_name")}),n.jsx(B,{name:"lastName",label:i("label.last_name")}),n.jsx(B,{name:"email",label:i("label.email")}),n.jsx(O,{chip:!0,checkbox:!0,name:"roles",label:i("add_user.roles"),options:v,isOptionDisabled:(e,t)=>{const r=t.includes(z.SUPER_ADMIN),a=t.includes(z.SURVEY_ADMIN);return!(!r&&!a)&&(r&&e!==z.SUPER_ADMIN||a&&e!==z.SURVEY_ADMIN)}})]}),n.jsxs(m,{sx:{display:"flex",gap:"1rem",justifyContent:"flex-end",mt:"40px"},children:[n.jsx(M,{onClick:()=>a(!0),color:"inherit",size:"large",variant:"contained",children:i("add_user.cancel")}),n.jsx(M,{color:"inherit",size:"large",type:"submit",variant:"contained",loading:f,children:i("add_user.save")})]})]})]})})}const fe=()=>{const t=C("user"),r=j("manage").t,a=e(c.useState([]),2),s=a[0],i=a[1],l=S(),o=e(c.useState(null),2),d=o[0],u=o[1],p=e(c.useState("asc"),2),x=p[0],f=p[1],_=e(c.useState("name"),2),g=_[0],v=_[1],w=e(c.useState(null),2),I=w[0],M=w[1],E=e(c.useState(null),2),k=E[0],T=E[1],L=e(c.useState(!1),2),$=L[0],q=L[1],V=A.getUser().id,z=()=>{l(N(!0)),t.getAllUsers().then((e=>{e&&i(e)})).finally((()=>{l(N(!1))}))},P=e(c.useState(null),2),B=P[0],O=P[1],Y=()=>{O(null)};c.useEffect((()=>{z()}),[]);const F=e=>{f(g===e&&"asc"===x?"desc":"asc"),v(e)},te=(e,t,r)=>{if("name"===r){const r=`${e.firstName} ${e.lastName}`.toLowerCase(),a=`${t.firstName} ${t.lastName}`.toLowerCase();return a<r?-1:a>r?1:0}return t[r]<e[r]?-1:t[r]>e[r]?1:0},re=((e,t)=>{const r=e.map(((e,t)=>[e,t]));return r.sort(((e,r)=>{const a=t(e[0],r[0]);return 0!==a?a:e[1]-r[1]})),r.map((e=>e[0]))})(s,(ae=g,"desc"===x?(e,t)=>te(e,t,ae):(e,t)=>-te(e,t,ae)));var ae;const ne=e(c.useState(!1),2),se=ne[0],ie=ne[1],ce=(e=null)=>{M(e),ie(!0)},ue=c.useCallback(((e,t)=>{u(e.currentTarget),T(t)}),[]),me=c.useCallback((()=>{u(null),T(null)}),[]);return n.jsxs(n.Fragment,{children:[n.jsxs(m,{display:"flex",justifyContent:"space-between",children:[n.jsx(b,{variant:"h5",sx:{mb:3},children:r("users_manage.users")}),n.jsxs(y,{className:de,onClick:()=>ce(),children:[n.jsx(oe,{}),r("users_manage.add_user")]})]}),n.jsx(H,{sx:{overflow:"unset",[`& .${K.head}`]:{color:"text.primary"},[`& .${K.root}`]:{bgcolor:"background.default",borderBottomColor:e=>e.palette.divider}},children:n.jsxs(Z,{sx:{minWidth:650},"aria-label":"simple table",children:[n.jsx(Q,{children:n.jsxs(G,{children:[n.jsx(X,{align:"left",children:n.jsx(le,{active:"name"===g,direction:"name"===g?x:"asc",onClick:()=>F("name"),children:r("users_manage.name")})}),n.jsx(X,{align:"left",children:n.jsx(le,{active:"email"===g,direction:"email"===g?x:"asc",onClick:()=>F("email"),children:r("users_manage.email")})}),n.jsx(X,{align:"left",children:n.jsx(le,{active:"roles"===g,direction:"roles"===g?x:"asc",onClick:()=>F("roles"),children:r("users_manage.roles")})}),n.jsx(X,{align:"left",children:n.jsx(le,{active:"status"===g,direction:"status"===g?x:"asc",onClick:()=>F("status"),children:r("users_manage.status")})})]})}),n.jsx(J,{children:re.map((e=>{const t=!e.isConfirmed||e.id===V;return n.jsxs(h.Fragment,{children:[n.jsxs(G,{children:[n.jsxs(X,{align:"left",children:[e.firstName," ",e.lastName]}),n.jsx(X,{align:"left",children:e.email}),n.jsx(X,{align:"left",children:e.roles.map((e=>r(`label.${e}`))).join(", ")}),n.jsx(X,{align:"left",children:e.isConfirmed?r("users_manage.active"):r("users_manage.invitation_sent")}),n.jsx(X,{align:"right",padding:"none",children:!t&&n.jsx(U,{onClick:t=>ue(t,e.id),children:n.jsx(W,{icon:"carbon:overflow-menu-vertical"})})})]},e.id),n.jsxs(R,{open:Boolean(d)&&k===e.id,anchorEl:d,onClose:me,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:160}}},children:[n.jsxs(D,{onClick:()=>{var t;t=e.id,ce(t),u(null)},children:[n.jsx(W,{icon:"carbon:edit",sx:{mr:1}})," ",r("users_manage.title_edit")]}),n.jsx(ee,{sx:{borderStyle:"dashed",mt:.5}}),n.jsxs(D,{onClick:()=>{u(null),O(e)},sx:{color:"error.main"},children:[n.jsx(W,{icon:"carbon:trash-can",sx:{mr:1}})," ",r("users_manage.title_delete")]})]})]},e.id)}))})]})}),Boolean(B)&&n.jsx(he,{deleteUser:()=>{q(!0),t.deleteUser({userId:B.id}).then((()=>{Y(),z(),q(!1)})).catch((e=>{q(!1)}))},name:B.firstName+" "+B.lastName,open:Boolean(B),onClose:Y,isLoading:$}),se&&n.jsx(xe,{userId:I,open:se,onClose:e=>{ie(!1),e||z()}})]})}}}}))}();
