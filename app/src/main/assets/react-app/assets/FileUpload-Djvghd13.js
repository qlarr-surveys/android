import{r as z,j as e,R as r,A as V}from"./index-DrdL8HT2.js";import{f as $,R as G,w as J,M as N,bc as O,H as A,U as P,aD as x,b1 as Q,a$ as k,b3 as W,aT as X}from"./use-service-0Fq5u1zn.js";import{a as U}from"./index-DQ4E-_8z.js";import{L as T}from"./Link-CSiWj_D0.js";import"./isTouchDevice-CHtK4r2d.js";import"./common-5BhfyGYi.js";import"./CardMedia-CIEe5zwn.js";import"./Card-Dppxln-L.js";import"./Toolbar-CWuxDDNF.js";const Y=$("input")({display:"none"});function de(i){var _,F,b,g,w,S,y,C;const q=G("run"),v=J(),{t:d}=N("run");let o=O((F=(_=i.component.validation)==null?void 0:_.validation_file_types)==null?void 0:F.fileTypes);const c=((g=(b=i.component.validation)==null?void 0:b.validation_max_file_size)==null?void 0:g.isActive)&&((S=(w=i.component.validation)==null?void 0:w.validation_max_file_size)==null?void 0:S.max_size)||-1,t=A(n=>{let s=n.runState.values[i.component.qualifiedCode];return s==null?void 0:s.value}),D=A(n=>n.runState.preview),m=P(),[a,u]=z.useState(),[l,f]=z.useState(!1),M=()=>{window.Android.previewFileUpload(t.stored_filename,t.filename)},p=!l&&a&&o.length>0&&!o.includes(a.type),h=!l&&a&&c>0&&a.size/1024>c,R=n=>{m(k(i.component.qualifiedCode)),u(n.target.files[0])},K=()=>{f(!0),W(q,i.component.qualifiedCode,D,a).then(n=>{f(!1),j(),m(X({componentCode:i.component.qualifiedCode,value:n}))}).catch(n=>{f(!1),console.error(n)})},j=()=>{u(void 0)},L=n=>{if(window.Android){const s=i.component.qualifiedCode;n.preventDefault(),window.Android.selectFile(s,(o==null?void 0:o.join(","))||"",c||-1),window["onFileSelected"+s]=(E,H,I)=>{m(k(i.component.qualifiedCode)),u({name:E,size:H,type:I})}}};let B=a&&!p&&!h;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(Y,{id:"contained-button-file",type:"file",accept:o?o.join(","):void 0,onChange:R}),e.jsx(x,{disabled:l,onClick:L,variant:"contained",component:"span",children:d("choose_file")})]}),a?e.jsxs(r.Fragment,{children:[e.jsxs("span",{children:["Â ",a.name," - ",Math.round(a.size/1024),"K"]}),B?e.jsx(x,{disabled:l,variant:"text",onClick:K,children:d("upload")}):"",e.jsx(x,{disabled:l,sx:{fontFamily:v.textStyles.text.font,fontSize:v.textStyles.text.size},variant:"text",onClick:j,children:d("cancel")})]}):"",h&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(U,{name:"validation_max_file_size",validation:(y=i.component.validation)==null?void 0:y.validation_max_file_size})]}),p&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(U,{name:"validation_file_types",validation:(C=i.component.validation)==null?void 0:C.validation_file_types})]}),l?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(V,{}),e.jsx("br",{}),e.jsx("span",{children:d("uploading")})]}):!t||!t.stored_filename?"":e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),window.Android?e.jsxs(T,{target:"_blank",onClick:M,children:[t.filename," - ",Math.round(t.size/1024),"K"]}):e.jsxs(T,{target:"_blank",href:Q(t.stored_filename),children:[t.filename," - ",Math.round(t.size/1024),"K"]})]})]})}export{de as default};
