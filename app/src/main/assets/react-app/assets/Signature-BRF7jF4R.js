<<<<<<<< HEAD:app/src/main/assets/react-app/assets/Signature-UxFyJB6C.js
import{P as K,a2 as $,r as S,e as Z,m as M}from"./index-DEJtCpby.js";import{O as tt,Q as et,D as H,H as nt,R as it,S as ot,U as V,y as X,W as at,J as rt}from"./Android-CZTyDRMm.js";var G={exports:{}};/*!
========
import{aa as K,p as $,r as S,w as Z,j as M}from"./index-Dk6dJ9ej.js";import{F as tt,R as et,H as V,U as nt,b2 as it,b3 as ot,aQ as H,b4 as at,aV as rt}from"./use-service-CuOd9RJq.js";import{B as X}from"./index-D8xbzhRJ.js";import"./isTouchDevice-BxZW9fIr.js";import"./common-DrzhiyDD.js";import"./Close-Coe7rEfx.js";import"./Card-vFcRbAK1.js";import"./Toolbar-C-_hleNE.js";var G={exports:{}};/*!
>>>>>>>> main:app/src/main/assets/react-app/assets/Signature-BRF7jF4R.js
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
<<<<<<<< HEAD:app/src/main/assets/react-app/assets/Signature-UxFyJB6C.js
 */function O(t,i,n){this.x=t,this.y=i,this.time=n||new Date().getTime()}O.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1};O.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))};O.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time};function F(t,i,n,e){this.startPoint=t,this.control1=i,this.control2=n,this.endPoint=e}F.prototype.length=function(){for(var t=10,i=0,n=void 0,e=void 0,o=0;o<=t;o+=1){var s=o/t,r=this._point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),u=this._point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){var d=r-n,a=u-e;i+=Math.sqrt(d*d+a*a)}n=r,e=u}return i};F.prototype._point=function(t,i,n,e,o){return i*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*e*(1-t)*t*t+o*t*t*t};function st(t,i,n){var e,o,s,r=null,u=0;n||(n={});var d=function(){u=n.leading===!1?0:Date.now(),r=null,s=t.apply(e,o),r||(e=o=null)};return function(){var a=Date.now();!u&&n.leading===!1&&(u=a);var c=i-(a-u);return e=this,o=arguments,c<=0||c>i?(r&&(clearTimeout(r),r=null),u=a,s=t.apply(e,o),r||(e=o=null)):!r&&n.trailing!==!1&&(r=setTimeout(d,c)),s}}function _(t,i){var n=this,e=i||{};this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=st(_.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=_.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(o){o.which===1&&(n._mouseButtonDown=!0,n._strokeBegin(o))},this._handleMouseMove=function(o){n._mouseButtonDown&&n._strokeMoveUpdate(o)},this._handleMouseUp=function(o){o.which===1&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(o))},this._handleTouchStart=function(o){if(o.targetTouches.length===1){var s=o.changedTouches[0];n._strokeBegin(s)}},this._handleTouchMove=function(o){o.preventDefault();var s=o.targetTouches[0];n._strokeMoveUpdate(s)},this._handleTouchEnd=function(o){var s=o.target===n._canvas;s&&(o.preventDefault(),n._strokeEnd(o))},this.on()}_.prototype.clear=function(){var t=this._ctx,i=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,i.width,i.height),t.fillRect(0,0,i.width,i.height),this._data=[],this._reset(),this._isEmpty=!0};_.prototype.fromDataURL=function(t){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=new Image,o=n.ratio||window.devicePixelRatio||1,s=n.width||this._canvas.width/o,r=n.height||this._canvas.height/o;this._reset(),e.src=t,e.onload=function(){i._ctx.drawImage(e,0,0,s,r)},this._isEmpty=!1};_.prototype.toDataURL=function(t){var i;switch(t){case"image/svg+xml":return this._toSVG();default:for(var n=arguments.length,e=Array(n>1?n-1:0),o=1;o<n;o++)e[o-1]=arguments[o];return(i=this._canvas).toDataURL.apply(i,[t].concat(e))}};_.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};_.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};_.prototype.isEmpty=function(){return this._isEmpty};_.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),typeof this.onBegin=="function"&&this.onBegin(t)};_.prototype._strokeUpdate=function(t){var i=t.clientX,n=t.clientY,e=this._createPoint(i,n),o=this._data[this._data.length-1],s=o&&o[o.length-1],r=s&&e.distanceTo(s)<this.minDistance;if(!(s&&r)){var u=this._addPoint(e),d=u.curve,a=u.widths;d&&a&&this._drawCurve(d,a.start,a.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor})}};_.prototype._strokeEnd=function(t){var i=this.points.length>2,n=this.points[0];if(!i&&n&&this._drawDot(n),n){var e=this._data[this._data.length-1],o=e[e.length-1];n.equals(o)||e.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(t)};_.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};_.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};_.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};_.prototype._createPoint=function(t,i,n){var e=this._canvas.getBoundingClientRect();return new O(t-e.left,i-e.top,n||new Date().getTime())};_.prototype._addPoint=function(t){var i=this.points,n=void 0;if(i.push(t),i.length>2){i.length===3&&i.unshift(i[0]),n=this._calculateCurveControlPoints(i[0],i[1],i[2]);var e=n.c2;n=this._calculateCurveControlPoints(i[1],i[2],i[3]);var o=n.c1,s=new F(i[1],e,o,i[2]),r=this._calculateCurveWidths(s);return i.shift(),{curve:s,widths:r}}return{}};_.prototype._calculateCurveControlPoints=function(t,i,n){var e=t.x-i.x,o=t.y-i.y,s=i.x-n.x,r=i.y-n.y,u={x:(t.x+i.x)/2,y:(t.y+i.y)/2},d={x:(i.x+n.x)/2,y:(i.y+n.y)/2},a=Math.sqrt(e*e+o*o),c=Math.sqrt(s*s+r*r),f=u.x-d.x,p=u.y-d.y,g=c/(a+c),w={x:d.x+f*g,y:d.y+p*g},y=i.x-w.x,P=i.y-w.y;return{c1:new O(u.x+y,u.y+P),c2:new O(d.x+y,d.y+P)}};_.prototype._calculateCurveWidths=function(t){var i=t.startPoint,n=t.endPoint,e={start:null,end:null},o=this.velocityFilterWeight*n.velocityFrom(i)+(1-this.velocityFilterWeight)*this._lastVelocity,s=this._strokeWidth(o);return e.start=this._lastWidth,e.end=s,this._lastVelocity=o,this._lastWidth=s,e};_.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)};_.prototype._drawPoint=function(t,i,n){var e=this._ctx;e.moveTo(t,i),e.arc(t,i,n,0,2*Math.PI,!1),this._isEmpty=!1};_.prototype._drawCurve=function(t,i,n){var e=this._ctx,o=n-i,s=Math.floor(t.length());e.beginPath();for(var r=0;r<s;r+=1){var u=r/s,d=u*u,a=d*u,c=1-u,f=c*c,p=f*c,g=p*t.startPoint.x;g+=3*f*u*t.control1.x,g+=3*c*d*t.control2.x,g+=a*t.endPoint.x;var w=p*t.startPoint.y;w+=3*f*u*t.control1.y,w+=3*c*d*t.control2.y,w+=a*t.endPoint.y;var y=i+a*o;this._drawPoint(g,w,y)}e.closePath(),e.fill()};_.prototype._drawDot=function(t){var i=this._ctx,n=typeof this.dotSize=="function"?this.dotSize():this.dotSize;i.beginPath(),this._drawPoint(t.x,t.y,n),i.closePath(),i.fill()};_.prototype._fromData=function(t,i,n){for(var e=0;e<t.length;e+=1){var o=t[e];if(o.length>1)for(var s=0;s<o.length;s+=1){var r=o[s],u=new O(r.x,r.y,r.time),d=r.color;if(s===0)this.penColor=d,this._reset(),this._addPoint(u);else if(s!==o.length-1){var a=this._addPoint(u),c=a.curve,f=a.widths;c&&f&&i(c,f,d)}}else{this._reset();var p=o[0];n(p)}}};_.prototype._toSVG=function(){var t=this,i=this._data,n=this._canvas,e=Math.max(window.devicePixelRatio||1,1),o=0,s=0,r=n.width/e,u=n.height/e,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"width",n.width),d.setAttributeNS(null,"height",n.height),this._fromData(i,function(h,x,k){var D=document.createElement("path");if(!isNaN(h.control1.x)&&!isNaN(h.control1.y)&&!isNaN(h.control2.x)&&!isNaN(h.control2.y)){var R="M "+h.startPoint.x.toFixed(3)+","+h.startPoint.y.toFixed(3)+" "+("C "+h.control1.x.toFixed(3)+","+h.control1.y.toFixed(3)+" ")+(h.control2.x.toFixed(3)+","+h.control2.y.toFixed(3)+" ")+(h.endPoint.x.toFixed(3)+","+h.endPoint.y.toFixed(3));D.setAttribute("d",R),D.setAttribute("stroke-width",(x.end*2.25).toFixed(3)),D.setAttribute("stroke",k),D.setAttribute("fill","none"),D.setAttribute("stroke-linecap","round"),d.appendChild(D)}},function(h){var x=document.createElement("circle"),k=typeof t.dotSize=="function"?t.dotSize():t.dotSize;x.setAttribute("r",k),x.setAttribute("cx",h.x),x.setAttribute("cy",h.y),x.setAttribute("fill",h.color),d.appendChild(x)});var a="data:image/svg+xml;base64,",c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+o+" "+s+" "+r+" "+u+'"')+(' width="'+r+'"')+(' height="'+u+'"')+">",f=d.innerHTML;if(f===void 0){var p=document.createElement("dummy"),g=d.childNodes;p.innerHTML="";for(var w=0;w<g.length;w+=1)p.appendChild(g[w].cloneNode(!0));f=p.innerHTML}var y="</svg>",P=c+f+y;return a+btoa(P)};_.prototype.fromData=function(t){var i=this;this.clear(),this._fromData(t,function(n,e){return i._drawCurve(n,e.start,e.end)},function(n){return i._drawDot(n)}),this._data=t};_.prototype.toData=function(){return this._data};const ht=Object.freeze(Object.defineProperty({__proto__:null,default:_},Symbol.toStringTag,{value:"Module"})),ut=K(ht);var j={exports:{}},Y;function ct(){return Y||(Y=1,function(t,i){(function(n,e){t.exports=e()})($,function(){return function(n){function e(s){if(o[s])return o[s].exports;var r=o[s]={exports:{},id:s,loaded:!1};return n[s].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var o={};return e.m=n,e.c=o,e.p="",e(0)}([function(n,e){function o(a){var c=a.getContext("2d"),f=a.width,p=a.height,g=c.getImageData(0,0,f,p).data,w=u(!0,f,p,g),y=u(!1,f,p,g),P=d(!0,f,p,g),h=d(!1,f,p,g),x=h-P+1,k=y-w+1,D=c.getImageData(P,w,x,k);return a.width=x,a.height=k,c.clearRect(0,0,x,k),c.putImageData(D,0,0),a}function s(a,c,f,p){return{red:p[4*(f*c+a)],green:p[4*(f*c+a)+1],blue:p[4*(f*c+a)+2],alpha:p[4*(f*c+a)+3]}}function r(a,c,f,p){return s(a,c,f,p).alpha}function u(a,c,f,p){for(var g=a?1:-1,w=a?0:f-1,y=w;a?y<f:y>-1;y+=g)for(var P=0;P<c;P++)if(r(P,y,c,p))return y;return null}function d(a,c,f,p){for(var g=a?1:-1,w=a?0:c-1,y=w;a?y<c:y>-1;y+=g)for(var P=0;P<f;P++)if(r(y,P,c,p))return y;return null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o}])})}(j)),j.exports}(function(t,i){(function(n,e){t.exports=e(tt,S,ut,ct())})($,function(n,e,o,s){return function(r){function u(a){if(d[a])return d[a].exports;var c=d[a]={exports:{},id:a,loaded:!1};return r[a].call(c.exports,c,c.exports,u),c.loaded=!0,c.exports}var d={};return u.m=r,u.c=d,u.p="",u(0)}([function(r,u,d){function a(m){return m&&m.__esModule?m:{default:m}}function c(m,v){var C={};for(var b in m)v.indexOf(b)>=0||Object.prototype.hasOwnProperty.call(m,b)&&(C[b]=m[b]);return C}function f(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function p(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!v||typeof v!="object"&&typeof v!="function"?m:v}function g(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}Object.defineProperty(u,"__esModule",{value:!0});var w=Object.assign||function(m){for(var v=1;v<arguments.length;v++){var C=arguments[v];for(var b in C)Object.prototype.hasOwnProperty.call(C,b)&&(m[b]=C[b])}return m},y=function(){function m(v,C){for(var b=0;b<C.length;b++){var l=C[b];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(v,l.key,l)}}return function(v,C,b){return C&&m(v.prototype,C),b&&m(v,b),v}}(),P=d(1),h=a(P),x=d(2),k=a(x),D=d(3),R=a(D),J=d(4),Q=a(J),U=function(m){function v(){var C,b,l,A;f(this,v);for(var N=arguments.length,q=Array(N),z=0;z<N;z++)q[z]=arguments[z];return b=l=p(this,(C=v.__proto__||Object.getPrototypeOf(v)).call.apply(C,[this].concat(q))),l._sigPad=null,l._excludeOurProps=function(){var E=l.props,T=(E.canvasProps,E.clearOnResize,c(E,["canvasProps","clearOnResize"]));return T},l.getCanvas=function(){return l._canvas},l.getTrimmedCanvas=function(){var E=document.createElement("canvas");return E.width=l._canvas.width,E.height=l._canvas.height,E.getContext("2d").drawImage(l._canvas,0,0),(0,Q.default)(E)},l.getSignaturePad=function(){return l._sigPad},l._checkClearOnResize=function(){l.props.clearOnResize&&l._resizeCanvas()},l._resizeCanvas=function(){var E=l.props.canvasProps||{},T=E.width,I=E.height;if(!T||!I){var W=l._canvas,L=Math.max(window.devicePixelRatio||1,1);T||(W.width=W.offsetWidth*L),I||(W.height=W.offsetHeight*L),W.getContext("2d").scale(L,L),l.clear()}},l.on=function(){return window.addEventListener("resize",l._checkClearOnResize),l._sigPad.on()},l.off=function(){return window.removeEventListener("resize",l._checkClearOnResize),l._sigPad.off()},l.clear=function(){return l._sigPad.clear()},l.isEmpty=function(){return l._sigPad.isEmpty()},l.fromDataURL=function(E,T){return l._sigPad.fromDataURL(E,T)},l.toDataURL=function(E,T){return l._sigPad.toDataURL(E,T)},l.fromData=function(E){return l._sigPad.fromData(E)},l.toData=function(){return l._sigPad.toData()},A=b,p(l,A)}return g(v,m),y(v,[{key:"componentDidMount",value:function(){this._sigPad=new R.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var C=this,b=this.props.canvasProps;return k.default.createElement("canvas",w({ref:function(l){C._canvas=l}},b))}}]),v}(x.Component);U.propTypes={velocityFilterWeight:h.default.number,minWidth:h.default.number,maxWidth:h.default.number,minDistance:h.default.number,dotSize:h.default.oneOfType([h.default.number,h.default.func]),penColor:h.default.string,throttle:h.default.number,onEnd:h.default.func,onBegin:h.default.func,canvasProps:h.default.object,clearOnResize:h.default.bool},U.defaultProps={clearOnResize:!0},u.default=U},function(r,u){r.exports=n},function(r,u){r.exports=e},function(r,u){r.exports=o},function(r,u){r.exports=s}])})})(G);var lt=G.exports;const dt=Z(lt),ft="_signatureCanvas_1bkvb_1",vt="_container_1bkvb_10",pt="_buttonContainer_1bkvb_14",B={signatureCanvas:ft,container:vt,buttonContainer:pt};function gt(t){const i=et("run"),[n,e]=S.useState(!1),[o,s]=S.useState(!1),[r,u]=S.useState(void 0),d=H(h=>{let x=h.runState.values[t.component.qualifiedCode];return x==null?void 0:x.value}),a=S.useRef(null),[c,f]=S.useState(400);S.useEffect(()=>{var h;f((h=a==null?void 0:a.current)==null?void 0:h.offsetWidth)},[a]),S.useEffect(()=>{const h=()=>{var x;f((x=a==null?void 0:a.current)==null?void 0:x.offsetWidth)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const p=H(h=>h.runState.preview),g=S.useRef(),w=nt(),y=()=>{var h;(h=g.current)==null||h.clear(),u(void 0),s(!1),e(!1)},P=()=>{const h=g.current.toDataURL("image/png");at(i,t.component.qualifiedCode,p,h,"signature.png").then(x=>{w(rt({componentCode:t.component.qualifiedCode,value:x}))}).catch(x=>{console.error(x)})};return S.useEffect(()=>{d&&d.stored_filename&&(s(!0),it(ot(d.stored_filename)).then(h=>{e(!1),u(h)}))},[d]),M.jsxs(M.Fragment,{children:[M.jsx(V,{sx:{backgroundColor:"background.default"},className:B.container,children:M.jsx(V,{ref:a,sx:{maxWidth:Math.min(c,400)+"px"},className:B.signatureCanvas,children:r?M.jsx("img",{src:r,style:{width:Math.min(c,400)+"px",height:"200px"}}):M.jsx(dt,{penColor:"red",clearOnResize:!0,onBegin:()=>{e(!0),s(!0)},ref:g,canvasProps:{width:Math.min(c,400),height:200}})})}),M.jsx("br",{}),M.jsxs("div",{className:B.buttonContainer,children:[M.jsx(X,{onClick:()=>y(),disabled:!o,children:"Clear"}),M.jsx(X,{onClick:()=>P(),disabled:!n,children:"Submit"})]})]})}export{gt as default};
========
 */function O(t,i,n){this.x=t,this.y=i,this.time=n||new Date().getTime()}O.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1};O.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))};O.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time};function F(t,i,n,e){this.startPoint=t,this.control1=i,this.control2=n,this.endPoint=e}F.prototype.length=function(){for(var t=10,i=0,n=void 0,e=void 0,o=0;o<=t;o+=1){var s=o/t,r=this._point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),u=this._point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){var d=r-n,a=u-e;i+=Math.sqrt(d*d+a*a)}n=r,e=u}return i};F.prototype._point=function(t,i,n,e,o){return i*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*e*(1-t)*t*t+o*t*t*t};function st(t,i,n){var e,o,s,r=null,u=0;n||(n={});var d=function(){u=n.leading===!1?0:Date.now(),r=null,s=t.apply(e,o),r||(e=o=null)};return function(){var a=Date.now();!u&&n.leading===!1&&(u=a);var c=i-(a-u);return e=this,o=arguments,c<=0||c>i?(r&&(clearTimeout(r),r=null),u=a,s=t.apply(e,o),r||(e=o=null)):!r&&n.trailing!==!1&&(r=setTimeout(d,c)),s}}function m(t,i){var n=this,e=i||{};this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=st(m.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=m.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(o){o.which===1&&(n._mouseButtonDown=!0,n._strokeBegin(o))},this._handleMouseMove=function(o){n._mouseButtonDown&&n._strokeMoveUpdate(o)},this._handleMouseUp=function(o){o.which===1&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(o))},this._handleTouchStart=function(o){if(o.targetTouches.length===1){var s=o.changedTouches[0];n._strokeBegin(s)}},this._handleTouchMove=function(o){o.preventDefault();var s=o.targetTouches[0];n._strokeMoveUpdate(s)},this._handleTouchEnd=function(o){var s=o.target===n._canvas;s&&(o.preventDefault(),n._strokeEnd(o))},this.on()}m.prototype.clear=function(){var t=this._ctx,i=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,i.width,i.height),t.fillRect(0,0,i.width,i.height),this._data=[],this._reset(),this._isEmpty=!0};m.prototype.fromDataURL=function(t){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=new Image,o=n.ratio||window.devicePixelRatio||1,s=n.width||this._canvas.width/o,r=n.height||this._canvas.height/o;this._reset(),e.src=t,e.onload=function(){i._ctx.drawImage(e,0,0,s,r)},this._isEmpty=!1};m.prototype.toDataURL=function(t){var i;switch(t){case"image/svg+xml":return this._toSVG();default:for(var n=arguments.length,e=Array(n>1?n-1:0),o=1;o<n;o++)e[o-1]=arguments[o];return(i=this._canvas).toDataURL.apply(i,[t].concat(e))}};m.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};m.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};m.prototype.isEmpty=function(){return this._isEmpty};m.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),typeof this.onBegin=="function"&&this.onBegin(t)};m.prototype._strokeUpdate=function(t){var i=t.clientX,n=t.clientY,e=this._createPoint(i,n),o=this._data[this._data.length-1],s=o&&o[o.length-1],r=s&&e.distanceTo(s)<this.minDistance;if(!(s&&r)){var u=this._addPoint(e),d=u.curve,a=u.widths;d&&a&&this._drawCurve(d,a.start,a.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor})}};m.prototype._strokeEnd=function(t){var i=this.points.length>2,n=this.points[0];if(!i&&n&&this._drawDot(n),n){var e=this._data[this._data.length-1],o=e[e.length-1];n.equals(o)||e.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(t)};m.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};m.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};m.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};m.prototype._createPoint=function(t,i,n){var e=this._canvas.getBoundingClientRect();return new O(t-e.left,i-e.top,n||new Date().getTime())};m.prototype._addPoint=function(t){var i=this.points,n=void 0;if(i.push(t),i.length>2){i.length===3&&i.unshift(i[0]),n=this._calculateCurveControlPoints(i[0],i[1],i[2]);var e=n.c2;n=this._calculateCurveControlPoints(i[1],i[2],i[3]);var o=n.c1,s=new F(i[1],e,o,i[2]),r=this._calculateCurveWidths(s);return i.shift(),{curve:s,widths:r}}return{}};m.prototype._calculateCurveControlPoints=function(t,i,n){var e=t.x-i.x,o=t.y-i.y,s=i.x-n.x,r=i.y-n.y,u={x:(t.x+i.x)/2,y:(t.y+i.y)/2},d={x:(i.x+n.x)/2,y:(i.y+n.y)/2},a=Math.sqrt(e*e+o*o),c=Math.sqrt(s*s+r*r),f=u.x-d.x,p=u.y-d.y,g=c/(a+c),w={x:d.x+f*g,y:d.y+p*g},y=i.x-w.x,C=i.y-w.y;return{c1:new O(u.x+y,u.y+C),c2:new O(d.x+y,d.y+C)}};m.prototype._calculateCurveWidths=function(t){var i=t.startPoint,n=t.endPoint,e={start:null,end:null},o=this.velocityFilterWeight*n.velocityFrom(i)+(1-this.velocityFilterWeight)*this._lastVelocity,s=this._strokeWidth(o);return e.start=this._lastWidth,e.end=s,this._lastVelocity=o,this._lastWidth=s,e};m.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)};m.prototype._drawPoint=function(t,i,n){var e=this._ctx;e.moveTo(t,i),e.arc(t,i,n,0,2*Math.PI,!1),this._isEmpty=!1};m.prototype._drawCurve=function(t,i,n){var e=this._ctx,o=n-i,s=Math.floor(t.length());e.beginPath();for(var r=0;r<s;r+=1){var u=r/s,d=u*u,a=d*u,c=1-u,f=c*c,p=f*c,g=p*t.startPoint.x;g+=3*f*u*t.control1.x,g+=3*c*d*t.control2.x,g+=a*t.endPoint.x;var w=p*t.startPoint.y;w+=3*f*u*t.control1.y,w+=3*c*d*t.control2.y,w+=a*t.endPoint.y;var y=i+a*o;this._drawPoint(g,w,y)}e.closePath(),e.fill()};m.prototype._drawDot=function(t){var i=this._ctx,n=typeof this.dotSize=="function"?this.dotSize():this.dotSize;i.beginPath(),this._drawPoint(t.x,t.y,n),i.closePath(),i.fill()};m.prototype._fromData=function(t,i,n){for(var e=0;e<t.length;e+=1){var o=t[e];if(o.length>1)for(var s=0;s<o.length;s+=1){var r=o[s],u=new O(r.x,r.y,r.time),d=r.color;if(s===0)this.penColor=d,this._reset(),this._addPoint(u);else if(s!==o.length-1){var a=this._addPoint(u),c=a.curve,f=a.widths;c&&f&&i(c,f,d)}}else{this._reset();var p=o[0];n(p)}}};m.prototype._toSVG=function(){var t=this,i=this._data,n=this._canvas,e=Math.max(window.devicePixelRatio||1,1),o=0,s=0,r=n.width/e,u=n.height/e,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"width",n.width),d.setAttributeNS(null,"height",n.height),this._fromData(i,function(h,x,k){var D=document.createElement("path");if(!isNaN(h.control1.x)&&!isNaN(h.control1.y)&&!isNaN(h.control2.x)&&!isNaN(h.control2.y)){var R="M "+h.startPoint.x.toFixed(3)+","+h.startPoint.y.toFixed(3)+" "+("C "+h.control1.x.toFixed(3)+","+h.control1.y.toFixed(3)+" ")+(h.control2.x.toFixed(3)+","+h.control2.y.toFixed(3)+" ")+(h.endPoint.x.toFixed(3)+","+h.endPoint.y.toFixed(3));D.setAttribute("d",R),D.setAttribute("stroke-width",(x.end*2.25).toFixed(3)),D.setAttribute("stroke",k),D.setAttribute("fill","none"),D.setAttribute("stroke-linecap","round"),d.appendChild(D)}},function(h){var x=document.createElement("circle"),k=typeof t.dotSize=="function"?t.dotSize():t.dotSize;x.setAttribute("r",k),x.setAttribute("cx",h.x),x.setAttribute("cy",h.y),x.setAttribute("fill",h.color),d.appendChild(x)});var a="data:image/svg+xml;base64,",c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+o+" "+s+" "+r+" "+u+'"')+(' width="'+r+'"')+(' height="'+u+'"')+">",f=d.innerHTML;if(f===void 0){var p=document.createElement("dummy"),g=d.childNodes;p.innerHTML="";for(var w=0;w<g.length;w+=1)p.appendChild(g[w].cloneNode(!0));f=p.innerHTML}var y="</svg>",C=c+f+y;return a+btoa(C)};m.prototype.fromData=function(t){var i=this;this.clear(),this._fromData(t,function(n,e){return i._drawCurve(n,e.start,e.end)},function(n){return i._drawDot(n)}),this._data=t};m.prototype.toData=function(){return this._data};const ht=Object.freeze(Object.defineProperty({__proto__:null,default:m},Symbol.toStringTag,{value:"Module"})),ut=K(ht);var j={exports:{}},Y;function ct(){return Y||(Y=1,function(t,i){(function(n,e){t.exports=e()})($,function(){return function(n){function e(s){if(o[s])return o[s].exports;var r=o[s]={exports:{},id:s,loaded:!1};return n[s].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var o={};return e.m=n,e.c=o,e.p="",e(0)}([function(n,e){function o(a){var c=a.getContext("2d"),f=a.width,p=a.height,g=c.getImageData(0,0,f,p).data,w=u(!0,f,p,g),y=u(!1,f,p,g),C=d(!0,f,p,g),h=d(!1,f,p,g),x=h-C+1,k=y-w+1,D=c.getImageData(C,w,x,k);return a.width=x,a.height=k,c.clearRect(0,0,x,k),c.putImageData(D,0,0),a}function s(a,c,f,p){return{red:p[4*(f*c+a)],green:p[4*(f*c+a)+1],blue:p[4*(f*c+a)+2],alpha:p[4*(f*c+a)+3]}}function r(a,c,f,p){return s(a,c,f,p).alpha}function u(a,c,f,p){for(var g=a?1:-1,w=a?0:f-1,y=w;a?y<f:y>-1;y+=g)for(var C=0;C<c;C++)if(r(C,y,c,p))return y;return null}function d(a,c,f,p){for(var g=a?1:-1,w=a?0:c-1,y=w;a?y<c:y>-1;y+=g)for(var C=0;C<f;C++)if(r(y,C,c,p))return y;return null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o}])})}(j)),j.exports}(function(t,i){(function(n,e){t.exports=e(tt,S,ut,ct())})($,function(n,e,o,s){return function(r){function u(a){if(d[a])return d[a].exports;var c=d[a]={exports:{},id:a,loaded:!1};return r[a].call(c.exports,c,c.exports,u),c.loaded=!0,c.exports}var d={};return u.m=r,u.c=d,u.p="",u(0)}([function(r,u,d){function a(_){return _&&_.__esModule?_:{default:_}}function c(_,v){var P={};for(var b in _)v.indexOf(b)>=0||Object.prototype.hasOwnProperty.call(_,b)&&(P[b]=_[b]);return P}function f(_,v){if(!(_ instanceof v))throw new TypeError("Cannot call a class as a function")}function p(_,v){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!v||typeof v!="object"&&typeof v!="function"?_:v}function g(_,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);_.prototype=Object.create(v&&v.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(_,v):_.__proto__=v)}Object.defineProperty(u,"__esModule",{value:!0});var w=Object.assign||function(_){for(var v=1;v<arguments.length;v++){var P=arguments[v];for(var b in P)Object.prototype.hasOwnProperty.call(P,b)&&(_[b]=P[b])}return _},y=function(){function _(v,P){for(var b=0;b<P.length;b++){var l=P[b];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(v,l.key,l)}}return function(v,P,b){return P&&_(v.prototype,P),b&&_(v,b),v}}(),C=d(1),h=a(C),x=d(2),k=a(x),D=d(3),R=a(D),Q=d(4),J=a(Q),U=function(_){function v(){var P,b,l,A;f(this,v);for(var N=arguments.length,q=Array(N),z=0;z<N;z++)q[z]=arguments[z];return b=l=p(this,(P=v.__proto__||Object.getPrototypeOf(v)).call.apply(P,[this].concat(q))),l._sigPad=null,l._excludeOurProps=function(){var E=l.props,T=(E.canvasProps,E.clearOnResize,c(E,["canvasProps","clearOnResize"]));return T},l.getCanvas=function(){return l._canvas},l.getTrimmedCanvas=function(){var E=document.createElement("canvas");return E.width=l._canvas.width,E.height=l._canvas.height,E.getContext("2d").drawImage(l._canvas,0,0),(0,J.default)(E)},l.getSignaturePad=function(){return l._sigPad},l._checkClearOnResize=function(){l.props.clearOnResize&&l._resizeCanvas()},l._resizeCanvas=function(){var E=l.props.canvasProps||{},T=E.width,I=E.height;if(!T||!I){var W=l._canvas,L=Math.max(window.devicePixelRatio||1,1);T||(W.width=W.offsetWidth*L),I||(W.height=W.offsetHeight*L),W.getContext("2d").scale(L,L),l.clear()}},l.on=function(){return window.addEventListener("resize",l._checkClearOnResize),l._sigPad.on()},l.off=function(){return window.removeEventListener("resize",l._checkClearOnResize),l._sigPad.off()},l.clear=function(){return l._sigPad.clear()},l.isEmpty=function(){return l._sigPad.isEmpty()},l.fromDataURL=function(E,T){return l._sigPad.fromDataURL(E,T)},l.toDataURL=function(E,T){return l._sigPad.toDataURL(E,T)},l.fromData=function(E){return l._sigPad.fromData(E)},l.toData=function(){return l._sigPad.toData()},A=b,p(l,A)}return g(v,_),y(v,[{key:"componentDidMount",value:function(){this._sigPad=new R.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var P=this,b=this.props.canvasProps;return k.default.createElement("canvas",w({ref:function(l){P._canvas=l}},b))}}]),v}(x.Component);U.propTypes={velocityFilterWeight:h.default.number,minWidth:h.default.number,maxWidth:h.default.number,minDistance:h.default.number,dotSize:h.default.oneOfType([h.default.number,h.default.func]),penColor:h.default.string,throttle:h.default.number,onEnd:h.default.func,onBegin:h.default.func,canvasProps:h.default.object,clearOnResize:h.default.bool},U.defaultProps={clearOnResize:!0},u.default=U},function(r,u){r.exports=n},function(r,u){r.exports=e},function(r,u){r.exports=o},function(r,u){r.exports=s}])})})(G);var lt=G.exports;const dt=Z(lt),ft="_signatureCanvas_1bkvb_1",vt="_container_1bkvb_10",pt="_buttonContainer_1bkvb_14",B={signatureCanvas:ft,container:vt,buttonContainer:pt};function Pt(t){const i=et("run"),[n,e]=S.useState(!1),[o,s]=S.useState(!1),[r,u]=S.useState(void 0),d=V(h=>{let x=h.runState.values[t.component.qualifiedCode];return x==null?void 0:x.value}),a=S.useRef(null),[c,f]=S.useState(400);S.useEffect(()=>{var h;f((h=a==null?void 0:a.current)==null?void 0:h.offsetWidth)},[a]),S.useEffect(()=>{const h=()=>{var x;f((x=a==null?void 0:a.current)==null?void 0:x.offsetWidth)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const p=V(h=>h.runState.preview),g=S.useRef(),w=nt(),y=()=>{var h;(h=g.current)==null||h.clear(),u(void 0),s(!1),e(!1)},C=()=>{const h=g.current.toDataURL("image/png");at(i,t.component.qualifiedCode,p,h,"signature.png").then(x=>{w(rt({componentCode:t.component.qualifiedCode,value:x}))}).catch(x=>{console.error(x)})};return S.useEffect(()=>{d&&d.stored_filename&&(s(!0),it(ot(d.stored_filename)).then(h=>{e(!1),u(h)}))},[d]),M.jsxs(M.Fragment,{children:[M.jsx(X,{sx:{backgroundColor:"background.default"},className:B.container,children:M.jsx(X,{ref:a,sx:{maxWidth:Math.min(c,400)+"px"},className:B.signatureCanvas,children:r?M.jsx("img",{src:r,style:{width:Math.min(c,400)+"px",height:"200px"}}):M.jsx(dt,{penColor:"red",clearOnResize:!0,onBegin:()=>{e(!0),s(!0)},ref:g,canvasProps:{width:Math.min(c,400),height:200}})})}),M.jsx("br",{}),M.jsxs("div",{className:B.buttonContainer,children:[M.jsx(H,{onClick:()=>y(),disabled:!o,children:"Clear"}),M.jsx(H,{onClick:()=>C(),disabled:!n,children:"Submit"})]})]})}export{Pt as default};
>>>>>>>> main:app/src/main/assets/react-app/assets/Signature-BRF7jF4R.js
