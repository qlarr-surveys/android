import{r as b,j as e,R as r,z as J}from"./index-BdaHkdQl.js";import{e as V,A as G,l as N,y as O,aJ as P,v as A,D as Q,an as f,ax as W,av as k,az as X,aq as Y}from"./use-service-D09swmN7.js";import{a as q}from"./index-Djh-vddw.js";import{L as U}from"./Link-Iys5U15E.js";import"./isTouchDevice-DBnnGyOq.js";import"./common-C_0iAd7K.js";import"./ArrowBack-l2Daik9b.js";const Z=V("input")({display:"none"});function le(i){var _,F,g,y,S,w,z,C;const D=G("run"),v=N(),{t:d}=O("run");let o=P((F=(_=i.component.validation)==null?void 0:_.validation_file_types)==null?void 0:F.fileTypes);const c=((y=(g=i.component.validation)==null?void 0:g.validation_max_file_size)==null?void 0:y.isActive)&&((w=(S=i.component.validation)==null?void 0:S.validation_max_file_size)==null?void 0:w.max_size)||-1,t=A(n=>{let s=n.runState.values[i.component.qualifiedCode];return s==null?void 0:s.value}),T=A(n=>n.runState.preview),m=Q(),[a,u]=b.useState(),[l,x]=b.useState(!1),M=()=>{window.Android.previewFileUpload(t.stored_filename,t.filename)},p=!l&&a&&o.length>0&&!o.includes(a.type),h=!l&&a&&c>0&&a.size/1024>c,K=n=>{m(k(i.component.qualifiedCode)),u(n.target.files[0])},L=()=>{x(!0),X(D,i.component.qualifiedCode,T,a).then(n=>{x(!1),j(),m(Y({componentCode:i.component.qualifiedCode,value:n}))}).catch(n=>{x(!1),console.error(n)})},j=()=>{u(void 0)},R=n=>{if(window.Android){const s=i.component.qualifiedCode;n.preventDefault(),window.Android.selectFile(s,(o==null?void 0:o.join(","))||"",c||-1),window["onFileSelected"+s]=(E,I,H)=>{m(k(i.component.qualifiedCode)),u({name:E,size:I,type:H})}}};let B=a&&!p&&!h;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(Z,{id:"contained-button-file",type:"file",accept:o?o.join(","):void 0,onChange:K}),e.jsx(f,{disabled:l,onClick:R,variant:"contained",component:"span",children:d("choose_file")})]}),a?e.jsxs(r.Fragment,{children:[e.jsxs("span",{children:["Â ",a.name," - ",Math.round(a.size/1024),"K"]}),B?e.jsx(f,{disabled:l,variant:"text",onClick:L,children:d("upload")}):"",e.jsx(f,{disabled:l,sx:{fontFamily:v.textStyles.text.font,fontSize:v.textStyles.text.size},variant:"text",onClick:j,children:d("cancel")})]}):"",h&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(q,{name:"validation_max_file_size",validation:(z=i.component.validation)==null?void 0:z.validation_max_file_size})]}),p&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(q,{name:"validation_file_types",validation:(C=i.component.validation)==null?void 0:C.validation_file_types})]}),l?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(J,{}),e.jsx("br",{}),e.jsx("span",{children:d("uploading")})]}):!t||!t.stored_filename?"":e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),window.Android?e.jsxs(U,{target:"_blank",onClick:M,children:[t.filename," - ",Math.round(t.size/1024),"K"]}):e.jsxs(U,{target:"_blank",href:W(t.stored_filename),children:[t.filename," - ",Math.round(t.size/1024),"K"]})]})]})}export{le as default};
