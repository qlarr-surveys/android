import{r as z,j as e,R as r,A as V}from"./index-vqe_o6H9.js";import{f as G,R as J,w as N,M as O,bb as P,H as A,U as Q,aD as x,b0 as W,a_ as k,b2 as X,aS as Y}from"./use-service-d2kt1S5h.js";import{a as U}from"./index-D63KqE_g.js";import{L as q}from"./Link-CTEjAUlp.js";import"./isTouchDevice-rwiiBbR0.js";import"./common-BD7EYaWJ.js";import"./Close-CWD1l4TR.js";import"./Card-CpAAQw08.js";import"./Toolbar-ZGLOM2Zn.js";const Z=G("input")({display:"none"});function de(i){var _,b,F,S,g,w,y,C;const D=J("run"),v=N(),{t:d}=O("run");let o=P((b=(_=i.component.validation)==null?void 0:_.validation_file_types)==null?void 0:b.fileTypes);const c=((S=(F=i.component.validation)==null?void 0:F.validation_max_file_size)==null?void 0:S.isActive)&&((w=(g=i.component.validation)==null?void 0:g.validation_max_file_size)==null?void 0:w.max_size)||-1,t=A(n=>{let s=n.runState.values[i.component.qualifiedCode];return s==null?void 0:s.value}),M=A(n=>n.runState.preview),m=Q(),[a,u]=z.useState(),[l,f]=z.useState(!1),T=()=>{window.Android.previewFileUpload(t.stored_filename,t.filename)},p=!l&&a&&o.length>0&&!o.includes(a.type),h=!l&&a&&c>0&&a.size/1024>c,R=n=>{m(k(i.component.qualifiedCode)),u(n.target.files[0])},K=()=>{f(!0),X(D,i.component.qualifiedCode,M,a).then(n=>{f(!1),j(),m(Y({componentCode:i.component.qualifiedCode,value:n}))}).catch(n=>{f(!1),console.error(n)})},j=()=>{u(void 0)},L=n=>{if(window.Android){const s=i.component.qualifiedCode;n.preventDefault(),window.Android.selectFile(s,(o==null?void 0:o.join(","))||"",c||-1),window["onFileSelected"+s]=(E,H,I)=>{m(k(i.component.qualifiedCode)),u({name:E,size:H,type:I})}}};let B=a&&!p&&!h;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(Z,{id:"contained-button-file",type:"file",accept:o?o.join(","):void 0,onChange:R}),e.jsx(x,{disabled:l,onClick:L,variant:"contained",component:"span",children:d("choose_file")})]}),a?e.jsxs(r.Fragment,{children:[e.jsxs("span",{children:["Â ",a.name," - ",Math.round(a.size/1024),"K"]}),B?e.jsx(x,{disabled:l,variant:"text",onClick:K,children:d("upload")}):"",e.jsx(x,{disabled:l,sx:{fontFamily:v.textStyles.text.font,fontSize:v.textStyles.text.size},variant:"text",onClick:j,children:d("cancel")})]}):"",h&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(U,{name:"validation_max_file_size",validation:(y=i.component.validation)==null?void 0:y.validation_max_file_size})]}),p&&e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx(U,{name:"validation_file_types",validation:(C=i.component.validation)==null?void 0:C.validation_file_types})]}),l?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(V,{}),e.jsx("br",{}),e.jsx("span",{children:d("uploading")})]}):!t||!t.stored_filename?"":e.jsxs(r.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),window.Android?e.jsxs(q,{target:"_blank",onClick:T,children:[t.filename," - ",Math.round(t.size/1024),"K"]}):e.jsxs(q,{target:"_blank",href:W(t.stored_filename),children:[t.filename," - ",Math.round(t.size/1024),"K"]})]})]})}export{de as default};
