!function(){function e(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function r(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?e(Object(a),!0).forEach((function(e){n(r,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))}))}return r}function n(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function t(e,r,n,t,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?r(l):Promise.resolve(l).then(t,a)}function a(e){return function(){var r=this,n=arguments;return new Promise((function(a,i){var s=e.apply(r,n);function o(e){t(s,a,i,o,l,"next",e)}function l(e){t(s,a,i,o,l,"throw",e)}o(void 0)}))}}function i(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i,s,o=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(t=i.call(n)).done)&&(o.push(t.value),o.length!==r);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,r)||function(e,r){if(e){if("string"==typeof e)return s(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}System.register(["./index-legacy-Bwbrwstt.js","./yup-legacy-BPybgIV0.js","./Web-legacy-D9gX3vQP.js","./use-service-legacy-DB5V2eHr.js","./use-boolean-legacy-0h4HgDrd.js","./Link-legacy-ClRfglf0.js","./index-legacy-D9AfAW5R.js","./InputAdornment-legacy-Doqwucug.js","./Checkbox-legacy-s7YHSryL.js","./SwitchBase-legacy-DkZqnrwV.js","./Tabs-legacy-D_oy2YVb.js","./radioClasses-legacy-BB4JHZf7.js","./tableRowClasses-legacy-SdATQ0p0.js","./TextField-legacy-Yi54z2Nj.js","./FormControlLabel-legacy-D78_YsBw.js"],(function(e,n){"use strict";var t,s,o,l,c,d,u,m,f,h,p,g,x,b,v,j,y,_,w,N,A,C,E,P,S,O,I,q,G,H,L,D,W,k,z,R;return{setters:[e=>{t=e.r,s=e.j,o=e.B,l=e.s},e=>{c=e.c,d=e.a,u=e.L,m=e.o,f=e.d,h=e.b},e=>{p=e.u,g=e.F,x=e.r,b=e.I,v=e.R,j=e.a,y=e.A},e=>{_=e.Q,w=e.aL,N=e.aK,A=e.as,C=e.T,E=e.aC,P=e.H,S=e.M,O=e.J,I=e.R,q=e.Y,G=e.aM,H=e.aJ,L=e.I,D=e.W},e=>{W=e.u},e=>{k=e.L},e=>{z=e.S},e=>{R=e.I},null,null,null,null,null,null,null],execute:function(){var n=document.createElement("style");n.textContent="._mainContainer_1gv2g_1{height:calc(100vh - 64px);overflow:auto;display:flex;justify-content:center;align-items:start;width:100vw}._content_1gv2g_10{margin-top:30px}._verifyContainer_rwmnr_1{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:-24px 24px 72px -8px rgba(145,158,171,.24);padding:32px;border-radius:16px;width:400px;background-color:#fff}\n/*$vite$:1*/",document.head.appendChild(n),e("default",(function(){const e=_("auth"),n=_("user"),x=l(),w=P((e=>e.editState.loading)),A=S("manage").t,E=W(),k=O.getUser().id,M=i(t.useState({}),2),Z=M[0],F=M[1],V=i(t.useState(!1),2),B=V[0],J=V[1],K=i(t.useState(!1),2),Q=K[0],Y=K[1],X=i(t.useState(!1),2),ee=X[0],re=X[1],ne=i(t.useState(!1),2),te=ne[0],ae=ne[1],ie=i(t.useState(U.NONE),2),se=ie[0],oe=ie[1],le=I(),ce=()=>{re(!1)};f(d,"noWhitespace",(function(e){return this.test("no-whitespace",e,(function(r){const n=this.path,t=this.createError;return!(null==r||!r.trim())||t({path:n,message:e})}))}));const de=e=>{let n={firstName:d().required(A("firstname_required")).noWhitespace(A("error.invalid_first_name")).max(50,A("error.first_name_too_long")).matches(/^[A-Za-z]+$/,A("error.invalid_first_name")),lastName:d().required(A("lastname_required")).noWhitespace(A("error.invalid_last_name")).max(50,A("error.last_name_too_long")).matches(/^[A-Za-z]+$/,A("error.invalid_last_name"))};return e===U.CHANGE_EMAIL&&(n=r(r({},n),{},{currentPassword:d().required(A("password_required")),email:d().required(A("email_required")).matches(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/i,A("error.invalid_email"))})),e===U.CHANGE_PASSWORD&&(n=r(r({},n),{},{currentPassword:d().required(A("password_required")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/,A("error.invalid_password")),newPassword:d().required(A("password_required")),confirmNewPassword:d().required(A("password_required")).oneOf([h("newPassword"),null],A("error.password_should_match"))})),c().shape(n)},ue=se===U.CHANGE_EMAIL||se===U.CHANGE_PASSWORD;const me=()=>{e.logout().then((()=>{x(D.login)})).catch((e=>{x(D.login)}))},fe=p({resolver:m(de(se)),defaultValues:{firstName:"",lastName:"",email:"",currentPassword:"",newPassword:"",confirmNewPassword:""}}),he=fe.watch,pe=fe.setError,ge=fe.reset,xe=fe.handleSubmit,be=he("email");t.useEffect((()=>{be!==Z.email?(ge(r(r({},fe.getValues()),{},{firstName:Z.firstName,lastName:Z.lastName})),Y(!0)):Y(!1)}),[be,Z.email,ge,fe]),t.useEffect((()=>{n.getUser({userId:k}).then((e=>{const r={firstName:e.firstName,lastName:e.lastName,email:e.email};F(e),ge(r)}))}),[ge,k]),t.useEffect((()=>{const e=de(se);fe.reset(r({},fe.getValues()),{errors:!0,schema:e})}),[se,fe]);const ve=xe(function(){var e=a((function*(e){const r=e.firstName,t=e.lastName,a=e.email,i=e.newPassword,s=e.currentPassword,o={};Z.firstName!==r&&(o.firstName=r),Z.lastName!==t&&(o.lastName=t),Z.email!==a&&(o.email=a),""!==s&&(o.password=s),""!==i&&(o.newPassword=i),le(q(!0)),n.updateUserProfile(o).then((()=>{o.email&&o.email!==Z.email?J(!0):ue?me():ae(!0)})).catch((e=>{e.name==G.DUPLICATE_EMAIL.name?pe("email",{type:"manual",message:A(`processed_errors.${e.name}`)}):e.name==G.WRONG_CREDENTIALS.name&&pe("currentPassword",{type:"manual",message:A("error.incorrect_password")})})).finally((()=>{le(q(!1))}))}));return function(r){return e.apply(this,arguments)}}());return s.jsx(o,{className:T.mainContainer,children:s.jsxs(H,{className:T.content,children:[te&&s.jsx(z,{success:"updated",left:"56"}),s.jsxs(g,{methods:fe,onSubmit:ve,children:[s.jsx(C,{variant:"h5",sx:{mb:3},children:"Personal"}),s.jsxs(o,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[s.jsx(v,{disabled:Q,name:"firstName",label:A("label.first_name")}),s.jsx(v,{disabled:Q,name:"lastName",label:A("label.last_name")}),s.jsx(v,{disabled:se!=U.CHANGE_EMAIL,name:"email",label:A("label.email")})]}),s.jsx(N,{spacing:3,sx:{my:5},children:s.jsxs(s.Fragment,{children:[se==U.CHANGE_PASSWORD&&s.jsxs("div",{children:[s.jsx(C,{variant:"h5",children:A("profile.change_password")}),s.jsx(C,{variant:"body2",sx:{color:"error.main",mb:1},children:A("profile.hint")})]}),se==U.CHANGE_EMAIL&&s.jsx(C,{variant:"body2",sx:{color:"error.main"},children:A("profile.hint")}),s.jsxs(N,{spacing:2.5,children:[ue&&s.jsx(v,{name:"currentPassword",label:A("label.password"),type:E.value?"text":"password",InputProps:{endAdornment:s.jsx(R,{position:"end",children:s.jsx(L,{onClick:E.onToggle,edge:"end",children:s.jsx(b,{icon:E.value?"carbon:view":"carbon:view-off"})})})}}),se==U.CHANGE_PASSWORD&&s.jsxs(s.Fragment,{children:[s.jsx(v,{name:"newPassword",label:A("label.new_password"),type:E.value?"text":"password",InputProps:{endAdornment:s.jsx(R,{position:"end",children:s.jsx(L,{onClick:E.onToggle,edge:"end",children:s.jsx(b,{icon:E.value?"carbon:view":"carbon:view-off"})})})}}),s.jsx(v,{name:"confirmNewPassword",label:A("label.confirm_new_password"),type:E.value?"text":"password",InputProps:{endAdornment:s.jsx(R,{position:"end",children:s.jsx(L,{onClick:E.onToggle,edge:"end",children:s.jsx(b,{icon:E.value?"carbon:view":"carbon:view-off"})})})}})]})]})]})}),s.jsxs(N,{spacing:1,direction:"row",children:[se==U.NONE&&s.jsx(u,{color:"inherit",size:"large",variant:"contained",onClick:()=>oe(U.CHANGE_EMAIL),children:A("profile.change_email")}),se==U.NONE&&s.jsx(u,{color:"inherit",size:"large",variant:"contained",onClick:()=>oe(U.CHANGE_PASSWORD),children:A("profile.change_password")}),ue&&s.jsx(u,{color:"inherit",size:"large",variant:"contained",onClick:()=>oe(U.NONE),children:A("profile.cancel")}),s.jsx(u,{color:"inherit",size:"large",type:"submit",variant:"contained",loading:w,children:A("profile.save")})]})]}),s.jsx($,{t:A,open:B,email:null==Z?void 0:Z.email,resend:ve,onClose:e=>{J(!1),e&&(re(!0),setTimeout((()=>{me()}),300)),oe(U.NONE),n.getUser({userId:k}).then((e=>{const r={firstName:e.firstName,lastName:e.lastName,email:e.email};F(e),ge(r)}))}}),s.jsx(j,{open:ee,autoHideDuration:6e3,onClose:ce,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:s.jsx(y,{onClose:ce,severity:"success",variant:"filled",sx:{width:"100%"},children:A("email.email_changed")})})]})})}));const T={mainContainer:"_mainContainer_1gv2g_1",content:"_content_1gv2g_10"},M={verifyContainer:"_verifyContainer_rwmnr_1"};function $({t:e,open:r,email:n,resend:l,onClose:f}){const h=_("user"),v=i(t.useState(!1),2),j=v[0],y=v[1],P=c().shape({pin:d().min(6,`${e("email.code_characters")}`).required(`${e("email.code_required")}`)}),S={pin:""},O=p({mode:"onChange",resolver:m(P),defaultValues:S}),I=O.handleSubmit,q=O.setError,G=O.reset,H=I(function(){var r=a((function*(r){y(!0),h.confirmEmail(r).then((()=>{y(!1),f(!0),G(S)})).catch((r=>{y(!1),q("pin",{type:"manual",message:e(`processed_errors.${r.name}`)})}))}));return function(e){return r.apply(this,arguments)}}());return s.jsx(w,{open:r,"aria-labelledby":"email-verification-modal","aria-describedby":"email-verification-modal-description",children:s.jsx(o,{className:M.verifyContainer,children:s.jsxs(N,{sx:{textAlign:"center"},children:[s.jsx(A,{alt:"email inbox",src:"/ic_email_inbox.svg",sx:{mb:5,width:96,height:96,mx:"auto"}}),s.jsx(C,{variant:"h3",children:e("email.check")}),s.jsxs(C,{variant:"body2",sx:{mt:2,mb:5,color:"text.secondary"},children:[e("email.confirmation_code1")," ",n," ",e("email.confirmation_code2")]}),s.jsxs(g,{methods:O,onSubmit:H,children:[s.jsx(x,{name:"pin"}),s.jsx(u,{fullWidth:!0,size:"large",color:"inherit",type:"submit",variant:"contained",loading:j,sx:{mt:3},children:e("email.verify")})]}),s.jsxs(C,{variant:"body2",align:"center",sx:{mt:3},children:[e("email.dont_have_code"),s.jsxs(k,{variant:"subtitle2",onClick:()=>l(),underline:"none",sx:{cursor:"pointer"},children:[" ",e("email.resend_code")]})]}),s.jsxs(E,{onClick:()=>f(!1),color:"inherit",sx:{mt:3,mx:"auto",alignItems:"center",display:"inline-flex"},children:[s.jsx(b,{icon:"carbon:chevron-left",width:16,sx:{mr:1}}),e("action_btn.close")]})]})})})}const U={NONE:"",CHANGE_EMAIL:"CHANGE_EMAIL",CHANGE_PASSWORD:"CHANGE_PASSWORD"}}}}))}();
