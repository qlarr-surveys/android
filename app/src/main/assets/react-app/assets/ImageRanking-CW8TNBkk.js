import{r as m,j as s,B as g,y as S}from"./index-vqe_o6H9.js";import{H as h,aR as k,U as w,a_ as f,aS as C,ap as q}from"./use-service-d2kt1S5h.js";import{b as E}from"./common-BD7EYaWJ.js";const R="_imageGrid_r4g8r_1",W="_imageContainer_r4g8r_5",H="_rankContainer_r4g8r_12",z="_rankValue_r4g8r_21",I="_imageFlexContainer_r4g8r_27",x={imageGrid:R,imageContainer:W,rankContainer:H,rankValue:z,imageFlexContainer:I};function $(e){const n=h(t=>{let a={};return e.component.answers.forEach(c=>{a[c.qualifiedCode]=t.runState.values[c.qualifiedCode].value}),a},k),o=w(),i=m.useRef(null),[u,r]=m.useState(800);m.useEffect(()=>{var t;r((t=i==null?void 0:i.current)==null?void 0:t.offsetWidth)},[i]);const d=(u-e.component.columns*e.component.spacing*2)/e.component.columns,l=d/(e.component.imageAspectRatio||1);m.useEffect(()=>{const t=()=>{var a;r((a=i==null?void 0:i.current)==null?void 0:a.offsetWidth)};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]);const v=t=>{if(o(f(e.component.qualifiedCode)),o(f(e.parentCode)),+n[t]>0)o(C({componentCode:t,undefined:void 0}));else{let c=Object.keys(n),b=c.map(j=>n[j]);for(var a=1;a<=c.length;a++)if(!b.includes(a)){o(C({componentCode:t,value:a}));return}}},y=h(t=>t.runState.values.Survey.lang),_=q.includes(y);return s.jsx(g,{sx:{gap:"".concat(e.component.spacing,"px"),justifyContent:_?"flex-end":"flex-start"},className:x.imageFlexContainer,children:e.component.answers.map(t=>s.jsx(F,{option:t,spacing:e.component.spacing,columns:e.component.columns,hideText:e.component.hideText,onClick:()=>v(t.qualifiedCode),parentCode:e.component.qualifiedCode,imageHeight:l,imageWidth:d},t.qualifiedCode))})}function F(e){var u,r;const n=S(),o=h(d=>{let l=d.runState.values[e.option.qualifiedCode];return{showAnswer:typeof(l==null?void 0:l.relevance)>"u"||l.relevance,value:(l==null?void 0:l.value)||0}},k),i=(u=e.option.resources)!=null&&u.image?"url('".concat(E(e.option.resources.image),"')"):"0";return s.jsxs(g,{sx:{flex:"0 1 calc(".concat(100/e.columns,"% - ").concat(e.spacing,"px)"),cursor:"pointer"},children:[s.jsx(g,{className:x.imageContainer,onClick:()=>e.onClick(),display:"flex",justifyContent:"center",alignItems:"center",style:{paddingTop:100/e.aspectRatio+"%",backgroundImage:i,backgroundColor:n.palette.background.default,borderRadius:"4px",boxShadow:2,height:e.imageHeight+"px",border:o.checked?"2px solid ".concat(n.palette.primary.main):"2px solid transparent"},children:o.value>0&&s.jsx("div",{style:{height:Math.min(e.imageHeight,e.imageWidth)+"px",width:Math.min(e.imageHeight,e.imageWidth)+"px",borderRadius:Math.min(e.imageHeight,e.imageWidth)/2+"px",fontSize:Math.min(e.imageHeight,e.imageWidth)/2+"px",background:n.palette.primary.main},className:x.rankContainer,children:s.jsx("span",{className:x.rankValue,style:{color:n.textStyles.text.color},children:o.value})})}),!e.hideText&&s.jsx(g,{sx:{fontFamily:n.textStyles.text.font,color:n.textStyles.text.color,fontSize:n.textStyles.text.size},children:(r=e.option.content)==null?void 0:r.label})]},e.option.code)}export{$ as default};
