import{h as R,r as u,b as dt,_ as _e,d as ke,j as e,q as Se,B as C,s as ut,y as pt,A as Ve}from"./index-DrdL8HT2.js";import{f as We,j as mt,x as ze,c as ht,e as he,K as be,I as z,T as E,bd as pe,M as ne,R as re,U as je,aL as Z,Z as I,aN as me,be as vt,bf as gt,aK as xt,aD as te,aY as Ae,aO as Fe,J as _t}from"./use-service-0Fq5u1zn.js";import{u as Ge,d as ft,a as yt,D as Ct}from"./Image-ulBc8ayd.js";import{s as Be,l as we}from"./DateUtils-Ce4EpQzP.js";import{b as M,g as St,C as U,E as Ye,S as bt,a as jt,A as Dt,i as ae,d as It,c as Tt,e as Ce,u as Et,F as Ot,R as $t,f as Pt,h as Rt,j as Me}from"./Web-f7YbRHTs.js";import{d as Nt}from"./dayjs.min-CQ9Dil70.js";import{d as kt}from"./Delete-CZJSvO2w.js";import{b as zt}from"./common-5BhfyGYi.js";import{T as qe}from"./TextField-DRWs31uB.js";import{C as Qe}from"./Check-ov53ur5e.js";import{C as Xe}from"./Card-Dppxln-L.js";import{C as At}from"./CardMedia-CIEe5zwn.js";import{D as Ft}from"./Divider-DhP1YW-k.js";import{c as Bt,a as wt,o as Mt,L as Ut}from"./yup-DIB40AAO.js";import{S as G}from"./survey-D2pw4t3m.js";import{T as Ht}from"./TablePagination-BIv43byg.js";import"./Checkbox-DbTDcKnM.js";import"./SwitchBase-9pSiC_Cg.js";import"./Tabs-CzcAv-q5.js";import"./radioClasses-CNZTtMI3.js";import"./tableRowClasses-Dzs-lpCH.js";import"./FormControlLabel-DFbM1-QV.js";import"./TableCell-DKckLh6O.js";import"./Toolbar-CWuxDDNF.js";function Lt(t){const{badgeContent:s,invisible:a=!1,max:c=99,showZero:d=!1}=t,i=Ge({badgeContent:s,max:c});let n=a;a===!1&&s===0&&!d&&(n=!0);const{badgeContent:o,max:h=c}=n?i:t,l=o&&Number(o)>h?"".concat(h,"+"):o;return{badgeContent:o,invisible:n,max:h,displayValue:l}}const Vt=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],fe=10,ye=4,Wt=t=>{const{color:s,anchorOrigin:a,invisible:c,overlap:d,variant:i,classes:n={}}=t,o={root:["root"],badge:["badge",i,c&&"invisible","anchorOrigin".concat(R(a.vertical)).concat(R(a.horizontal)),"anchorOrigin".concat(R(a.vertical)).concat(R(a.horizontal)).concat(R(d)),"overlap".concat(R(d)),s!=="default"&&"color".concat(R(s))]};return ht(o,St,n)},Gt=We("span",{name:"MuiBadge",slot:"Root",overridesResolver:(t,s)=>s.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Yt=We("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.badge,s[a.variant],s["anchorOrigin".concat(R(a.anchorOrigin.vertical)).concat(R(a.anchorOrigin.horizontal)).concat(R(a.overlap))],a.color!=="default"&&s["color".concat(R(a.color))],a.invisible&&s.invisible]}})(({theme:t})=>{var s;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:fe*2,lineHeight:1,padding:"0 6px",height:fe*2,borderRadius:fe,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys(((s=t.vars)!=null?s:t).palette).filter(a=>{var c,d;return((c=t.vars)!=null?c:t).palette[a].main&&((d=t.vars)!=null?d:t).palette[a].contrastText}).map(a=>({props:{color:a},style:{backgroundColor:(t.vars||t).palette[a].main,color:(t.vars||t).palette[a].contrastText}})),{props:{variant:"dot"},style:{borderRadius:ye,height:ye*2,minWidth:ye*2,padding:0}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(M.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}}),Ue=u.forwardRef(function(s,a){var c,d,i,n,o,h;const l=mt({props:s,name:"MuiBadge"}),{anchorOrigin:b={vertical:"top",horizontal:"right"},className:x,component:_,components:f={},componentsProps:y={},children:J,overlap:F="rectangular",color:Y="default",invisible:j=!1,max:N=99,badgeContent:v,slots:B,slotProps:T,showZero:H=!1,variant:g="standard"}=l,O=dt(l,Vt),{badgeContent:$,invisible:A,max:L,displayValue:oe}=Lt({max:N,invisible:j,badgeContent:v,showZero:H}),ie=Ge({anchorOrigin:b,color:Y,overlap:F,variant:g,badgeContent:v}),le=A||$==null&&g!=="dot",{color:V=Y,overlap:ve=F,anchorOrigin:ce=b,variant:W=g}=le?ie:l,q=W!=="dot"?oe:void 0,w=_e({},l,{badgeContent:$,invisible:le,max:L,displayValue:q,showZero:H,anchorOrigin:ce,color:V,overlap:ve,variant:W}),Q=Wt(w),de=(c=(d=B==null?void 0:B.root)!=null?d:f.Root)!=null?c:Gt,ee=(i=(n=B==null?void 0:B.badge)!=null?n:f.Badge)!=null?i:Yt,X=(o=T==null?void 0:T.root)!=null?o:y.root,K=(h=T==null?void 0:T.badge)!=null?h:y.badge,ge=ze({elementType:de,externalSlotProps:X,externalForwardedProps:O,additionalProps:{ref:a,as:_},ownerState:w,className:ke(X==null?void 0:X.className,Q.root,x)}),xe=ze({elementType:ee,externalSlotProps:K,ownerState:w,className:ke(Q.badge,K==null?void 0:K.className)});return e.jsxs(de,_e({},ge,{children:[J,e.jsx(ee,_e({},xe,{children:q}))]}))}),He=he(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),Le=he(e.jsx("path",{d:"M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H9V4h9zM3 15v-2h2v2zm0-5.5h2v2H3zM10 20h2v2h-2zm-7-1.5v-2h2v2zM5 22c-1.1 0-2-.9-2-2h2zm3.5 0h-2v-2h2zm5 0v-2h2c0 1.1-.9 2-2 2M5 6v2H3c0-1.1.9-2 2-2"}),"CopyAll"),qt=he(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),Qt=he(e.jsx("path",{d:"M6 6h12v12H6z"}),"Stop"),Xt="_mainContainer_1kl2v_1",Kt="_newSurveysButton_1kl2v_8",Zt="_content_1kl2v_13",Jt="_loadingWrapper_1kl2v_20",ea="_allButton_1kl2v_27",ta="_surveyCardsContainer_1kl2v_43",aa="_noSurveys_1kl2v_51",se={mainContainer:Xt,newSurveysButton:Kt,content:Zt,loadingWrapper:Jt,allButton:ea,surveyCardsContainer:ta,noSurveys:aa};var De={},sa=Se;Object.defineProperty(De,"__esModule",{value:!0});var Ke=De.default=void 0,ra=sa(be()),na=e;Ke=De.default=(0,ra.default)((0,na.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Article");const oa="_surveyHeader_966ma_1",ia="_contentCard_966ma_7",la="_actionBtn_966ma_11",ca="_card_966ma_17",da="_cardContent_966ma_22",ua="_imageContainer_966ma_28",pa="_surveyContent_966ma_35",ma="_surveyTitle_966ma_43",ha="_surveyStatus_966ma_48",va="_badge_966ma_55",ga="_textTransform_966ma_61",xa="_surveyResponse_966ma_65",_a="_surveyActions_966ma_72",fa="_iconButton_966ma_82",ya="_logo_966ma_126",Ca="_logoImageWrapper_966ma_139",Sa="_imageOverlay_966ma_143",ba="_cameraIconWrapper_966ma_155",ja="_cameraIcon_966ma_155",Da="_relativeContainer_966ma_182",Ia="_absoluteOverlay_966ma_187",Ta="_container_966ma_200",Ea="_truncatedText_966ma_206",Oa="_exampleTruncatedText_966ma_220",$a="_titleContainer_966ma_235",Pa="_surveyLink_966ma_243",Ra="_nameIcon_966ma_248",Na="_descriptionContainer_966ma_259",ka="_descriptionIcon_966ma_272",za="_photoIcon_966ma_281",Aa="_highlight_966ma_294",Fa="_fadeHighlight_966ma_1",p={surveyHeader:oa,contentCard:ia,actionBtn:la,card:ca,cardContent:da,imageContainer:ua,surveyContent:pa,surveyTitle:ma,surveyStatus:ha,badge:va,textTransform:ga,surveyResponse:xa,surveyActions:_a,iconButton:fa,logo:ya,logoImageWrapper:Ca,imageOverlay:Sa,cameraIconWrapper:ba,cameraIcon:ja,relativeContainer:Da,absoluteOverlay:Ia,container:Ta,truncatedText:Ea,exampleTruncatedText:Oa,titleContainer:$a,surveyLink:Pa,nameIcon:Ra,descriptionContainer:Na,descriptionIcon:ka,photoIcon:za,highlight:Aa,fadeHighlight:Fa};function ue(t,s){return t?Nt(t).format("DD MMM YYYY"):""}var Ie={},Ba=Se;Object.defineProperty(Ie,"__esModule",{value:!0});var Ze=Ie.default=void 0,wa=Ba(be()),Ma=e;Ze=Ie.default=(0,wa.default)((0,Ma.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"}),"FormatQuote");var Te={},Ua=Se;Object.defineProperty(Te,"__esModule",{value:!0});var Je=Te.default=void 0,Ha=Ua(be()),La=e;Je=Te.default=(0,Ha.default)((0,La.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning");const Va=({survey:t,onSave:s,isEditable:a=!0})=>{const[c,d]=u.useState(!1),[i,n]=u.useState(t.name),o=x=>{const _=x.target.value;_.length<=50&&n(_)},h=()=>{i.trim()===""?n(t.name):i!==t.name&&s(i,()=>n(t.name)),d(!1)},l=x=>{x.key==="Enter"&&h()},b=x=>{x.stopPropagation(),d(!0)};return e.jsx(C,{className:p.titleContainer,children:c?e.jsxs(e.Fragment,{children:[e.jsx(qe,{sx:{px:3,flexGrow:1},value:i,onChange:o,onKeyDown:l,autoFocus:!0,variant:"standard",fullWidth:!0,InputProps:{style:{color:"white"}}}),e.jsx(z,{className:p.saveIcon,onClick:h,sx:{ml:1},children:e.jsx(Qe,{sx:{color:"white"}})})]}):e.jsxs(e.Fragment,{children:[i.length>20?e.jsx(U,{title:i,showIcon:!1,children:e.jsx(E,{variant:"h4",sx:{px:3},noWrap:!0,children:pe(i,18)})}):e.jsx(E,{variant:"h4",sx:{px:3},noWrap:!0,children:pe(i,18)}),a&&e.jsx(z,{className:p.nameIcon,onClick:b,sx:{ml:1},children:e.jsx(Ye,{sx:{color:"white"}})})]})})},Wa=({survey:t,onSave:s,isEditable:a=!0,isExample:c})=>{const[d,i]=u.useState(!1),[n,o]=u.useState(t.description),h=c?450:125,l=f=>{o(f.target.value)},b=()=>{n!==t.description&&s(n,()=>o(t.description)),i(!1)},x=f=>{f.key==="Enter"&&b()},_=f=>{f.stopPropagation(),i(!0)};return e.jsx(C,{className:p.descriptionContainer,children:d?e.jsxs(e.Fragment,{children:[e.jsx(qe,{sx:{px:3},value:n,onChange:l,onKeyDown:x,autoFocus:!0,variant:"standard",fullWidth:!0,multiline:!0,rows:3}),e.jsx(z,{className:"".concat(p.saveIcon),onClick:b,sx:{ml:1},children:e.jsx(Qe,{sx:{color:"gray"}})})]}):e.jsxs(e.Fragment,{children:[(n==null?void 0:n.length)>h?e.jsx(U,{title:n,showIcon:!1,children:e.jsx(E,{variant:"caption",sx:{px:3,color:n?"inherit":"gray",flexGrow:1},className:"".concat(c?p.exampleTruncatedText:p.truncatedText),children:pe(n,h)||"Click to add a description..."})}):e.jsx(E,{variant:"caption",sx:{px:3,color:n?"inherit":"gray",flexGrow:1},className:"".concat(c?p.exampleTruncatedText:p.truncatedText),children:pe(n,h)||"Click to add a description..."}),a&&e.jsx(z,{className:"".concat(p.descriptionIcon),onClick:_,sx:{ml:1},children:e.jsx(Ye,{sx:{color:"gray"}})})]})})},m={DRAFT:"draft",CLOSED:"closed",ACTIVE:"active",EXPIRED:"expired",SCHEDULED:"scheduled"},Ga=t=>{switch(t.status){case"draft":return m.DRAFT;case"closed":return m.CLOSED;case"active":return t.endDate&&Be(t.endDate)<Date.now()?m.EXPIRED:t.startDate&&Be(t.startDate)>Date.now()?m.SCHEDULED:m.ACTIVE;default:return m.DRAFT}},Ya=t=>{switch(t){case m.DRAFT:return"#e9db3e";case m.CLOSED:return"#d32f2f";case m.EXPIRED:return"#9d4435";case m.SCHEDULED:return"#607d8b";case m.ACTIVE:return"#669834";default:return}},et=({survey:t,example:s=!1,highlight:a,onClone:c,onDelete:d,onClose:i,onUpdateTitle:n,onUpdateDescription:o,onUpdateImage:h})=>{const{t:l}=ne("manage"),b=Ga(t),x=re("survey"),_=re("design"),[f,y]=u.useState(!1),[J,F]=u.useState(null),Y=ut(),j=je(),N=pt(),v=(g,O)=>{j(I(!0)),x.putSurvey({...t,name:g},t.id).then(()=>{n(t.id,g)}).catch($=>{$.name==me.DUPLICATE_SURVEY_NAME.name&&(F(l("processed_errors.".concat($.name))),y(!0),O())}).finally(()=>{j(I(!1))})},B=g=>{j(I(!0)),x.putSurvey({...t,description:g},t.id).then(()=>{o(t.id,g)}).catch(O=>{}).finally(()=>{j(I(!1))})},T=()=>{y(!1)},H=g=>{const O=g.target.files[0],$=new FileReader;$.onload=()=>{_.uploadResource(O,t.id).then(A=>{x.putSurvey({image:A.name},t.id).then(L=>{h(t.id,A.name)}).catch(L=>{F(l("processed_errors.".concat(L.name))),y(!0)}).finally(()=>{j(I(!1))})}).catch(A=>{F(l("processed_errors.".concat(A.name))),y(!0)}).finally(()=>{j(I(!1))})},$.readAsDataURL(O)};return e.jsxs(e.Fragment,{children:[e.jsx(bt,{}),e.jsx(jt,{open:f,autoHideDuration:6e3,onClose:T,children:e.jsx(Dt,{onClose:T,severity:"error",children:J})}),e.jsxs(Xe,{sx:{"&:hover":{boxShadow:g=>g.customShadows.z24}},className:"".concat(a?p.highlight:""),children:[e.jsxs(Z,{sx:{pb:0},children:[e.jsxs(Z,{spacing:.5,sx:{mb:1},children:[e.jsxs(C,{className:p.relativeContainer,children:[e.jsx(C,{className:p.absoluteOverlay,children:e.jsx(Va,{survey:t,onSave:v,isEditable:ae()&&!s})}),e.jsxs(C,{className:p.logo,children:[e.jsxs(C,{className:"".concat(p.logoImageWrapper),children:[e.jsx(At,{component:"img",image:t.image?zt(t.image,t.id,s):"/qlarr.png",height:"150"}),e.jsx(C,{className:p.imageOverlay}),ae()&&!t.example&&e.jsx(C,{className:p.photoIcon,onClick:g=>{g.stopPropagation(),document.getElementById("imageInput-".concat(t.id)).click()},children:e.jsx(ft,{className:p.cameraIcon})})]}),e.jsx("input",{id:"imageInput-".concat(t.id),type:"file",accept:"image/*",style:{display:"none"},onChange:H})]})]}),e.jsx(Wa,{survey:t,isExample:s,onSave:B,isEditable:ae()&&!s}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{direction:"row",alignItems:"center",spacing:.5,sx:{px:3,typography:"body2",color:"text.secondary"},children:[e.jsx("span",{style:{backgroundColor:Ya(b)},className:p.badge})," ",e.jsx(E,{variant:"subtitle2",className:p.textTransform,children:l("status.".concat(b))})]}),e.jsxs(C,{sx:{px:3,display:"flex",gap:2,my:.5},children:[!s&&t.status!=="closed"&&t.latestVersion.published===!1&&e.jsx(U,{title:"Has unpublished changes",showIcon:!1,children:e.jsx(Je,{sx:{color:"text.secondary"}})}),e.jsx(U,{showIcon:!1,title:"Complete Responses: ".concat(t.completeResponseCount),children:e.jsx(Ue,{badgeContent:t.completeResponseCount,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(It,{sx:{color:"text.secondary"}})})}),e.jsx(U,{showIcon:!1,title:t.surveyQuota>0?"Quota: ".concat(t.surveyQuota):"No Quota",children:e.jsx(Ue,{badgeContent:t.surveyQuota>0?t.surveyQuota:0,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ze,{sx:{color:"text.secondary"}})})})]})]})]}),e.jsxs(E,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:l("edit_survey.metadata.created")}),":"," ",ue(t.creationDate)]}),e.jsxs(E,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:l("edit_survey.metadata.last_modified")}),":"," ",ue(t.lastModified)]}),!s&&t.startDate&&e.jsxs(E,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:l("edit_survey.metadata.start_date")}),":"," ",ue(t.startDate)]}),!s&&t.endDate&&e.jsxs(E,{variant:"caption",sx:{px:3,color:"text.disabled"},children:[e.jsx("strong",{children:l("edit_survey.metadata.end_date")}),":"," ",ue(t.endDate)]})]}),e.jsx(Ft,{sx:{borderStyle:"dashed",my:1}}),e.jsxs(Z,{sx:{p:3,pt:0,typography:"body2",color:"text.secondary",textTransform:"capitalize"},className:p.surveyActions,children:[e.jsx(z,{className:p.iconButton,sx:{backgroundColor:N.palette.primary.main,"&:hover":{backgroundColor:N.palette.primary.main}},"aria-label":"redirect",size:"large",onClick:g=>{g.stopPropagation();const O=t.example?"/guest/preview/".concat(t.id):"/design-survey/".concat(t.id);Y(O)},children:s?e.jsx(yt,{sx:{color:"#fff"}}):e.jsx(Ke,{sx:{color:"#fff"}})}),ae()&&!s&&t.status==="active"&&e.jsx(U,{showIcon:!1,title:l("edit_survey.close_title"),children:e.jsx(z,{className:p.iconButton,"aria-label":"stop",size:"large",onClick:()=>i(t.id),children:e.jsx(Qt,{color:"primary"})})}),ae()&&e.jsx(U,{showIcon:!1,title:l("edit_survey.clone_survey"),children:e.jsx(z,{className:p.iconButton,"aria-label":"clone",size:"large",onClick:c,children:e.jsx(Tt,{color:"primary"})})}),!s&&t.status!==m.ACTIVE&&e.jsx(U,{showIcon:!1,title:l("action_btn.delete"),children:e.jsx(z,{className:p.iconButton,"aria-label":"delete",size:"large",onClick:()=>d(t.id),children:e.jsx(kt,{color:"primary"})})})]})]})]})},qa=({sort:t,filter:s,onFilterSelected:a,onSortSelected:c})=>{const d=[{value:"responses_desc",label:"survey_sort_options.responses_desc"},{value:"last_modified_desc",label:"survey_sort_options.last_modified_desc"}],i=[{value:"all",label:"status.all"},{value:m.ACTIVE,label:"status.".concat(m.ACTIVE)},{value:m.SCHEDULED,label:"status.".concat(m.SCHEDULED)},{value:m.DRAFT,label:"status.".concat(m.DRAFT)},{value:m.EXPIRED,label:"status.".concat(m.EXPIRED)},{value:m.CLOSED,label:"status.".concat(m.CLOSED)}],{t:n}=ne("manage");return e.jsxs(C,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(E,{variant:"h5",flex:"1",textTransform:"uppercase",fontWeight:"600",children:n("my_surveys")}),e.jsxs(Z,{width:"100%",spacing:2.5,direction:{xs:"column",md:"row"},alignItems:"center",children:[e.jsx(Ce,{onChange:c,native:!0,value:t,name:"Status",label:n("label.sort_by"),children:d.map(o=>e.jsx("option",{value:o.value,children:n(o.label)},o.value))}),e.jsx(Ce,{onChange:a,native:!0,value:s,name:"Status",label:n("edit_survey.status"),children:i.map(o=>e.jsx("option",{value:o.value,children:n(o.label)},o.value))})]})]})},Qa="_exampleSurveysContainer_apkeh_1",Xa={exampleSurveysContainer:Qa},Ka=({onClone:t})=>{const{t:s}=ne("manage"),[a,c]=u.useState(!1),[d,i]=u.useState([]),n=re("survey");return u.useEffect(()=>{c(!0),n.getGuestsSurveys().then(o=>{if(c(!1),o){const h=o.map(l=>({...l,example:!0}));i(h)}}).catch(o=>{c(!1),vt(o)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(E,{variant:"h5",marginBottom:2,fontWeight:600,textTransform:"uppercase",children:s("example_surveys")}),a?e.jsx(Ve,{}):e.jsx(C,{className:Xa.exampleSurveysContainer,sx:{mt:3,columnGap:4,display:"grid",rowGap:{xs:4,md:5},gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:d==null?void 0:d.map(o=>e.jsx(et,{survey:o,onClone:()=>t(o),example:!0},o.id))})]})},Za="_createUserCard_zrfc2_1",Ja="_formGroup_zrfc2_9",es="_rightContainer_zrfc2_16",ts="_createButton_zrfc2_24",as="_surveyNameInput_zrfc2_39",ss="_selectInput_zrfc2_55",rs="_errorText_zrfc2_63",ns={createUserCard:Za,formGroup:Ja,rightContainer:es,createButton:ts,surveyNameInput:as,selectInput:ss,errorText:rs},os=[{value:G.WEB,label:"mode.".concat(G.WEB)},{value:G.OFFLINE,label:"mode.".concat(G.OFFLINE)},{value:G.MIXED,label:"mode.".concat(G.MIXED)}];function is({onSurveyCreated:t}){const s=re("survey"),{t:a}=ne("manage"),c=je(),d={surveyName:"",surveyMode:G.MIXED,surveyActiveFrom:"",surveyActiveTo:""},i=Bt().shape({surveyName:wt().required(a("survey_required")).max(50,a("survey_too_long"))}),n=Et({resolver:Mt(i),defaultValues:d}),{setError:o,reset:h,handleSubmit:l,formState:{isSubmitting:b}}=n,x=l(async _=>{c(I(!0));const f={name:_.surveyName,usage:_.surveyMode};_.surveyActiveFrom&&(f.startDate=we(surveyActiveFrom)),_.surveyActiveTo&&(f.endDate=we(surveyActiveTo)),s.createSurvey(f).then(()=>{t&&(t(f),h())}).catch(y=>{y.name==me.DUPLICATE_SURVEY_NAME.name?o("surveyName",{type:"manual",message:a("processed_errors.".concat(y.name))}):y.name==me.INVALID_SURVEY_DATES.name&&o("surveyActiveFrom",{type:"manual",message:a("processed_errors.".concat(y.name))})}).finally(()=>{c(I(!1))})});return e.jsx(Xe,{className:ns.createUserCard,children:e.jsx(Ot,{methods:n,onSubmit:x,children:e.jsxs(C,{rowGap:2.5,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(3, 1fr)"},children:[e.jsx($t,{name:"surveyName",label:a("label.survey_name")}),e.jsx(Ce,{name:"surveyMode",label:a("label.survey_mode"),children:os.map(_=>e.jsx("option",{value:_.value,children:a(_.label)},_.value))}),e.jsx(Ut,{fullWidth:!0,size:"large",color:"primary",type:"submit",variant:"contained",loading:b,children:a("action_btn.create")})]})})})}function Rs(){var $e,Pe,Re,Ne;const t=re("survey"),[s,a]=u.useState(null),[c,d]=u.useState(!0),[i,n]=u.useState(1),[o,h]=u.useState(5),[l,b]=u.useState("all"),[x,_]=u.useState("last_modified_desc"),[f,y]=u.useState(!1),[J,F]=u.useState(),[Y,j]=u.useState(null),N=je(),{t:v}=ne("manage"),B=r=>{d(!1)},T=()=>{t.getAllSurveys(i,o,l,x).then(r=>{r&&(d(!1),a(r),q(!1),Q(!1))}).catch(r=>B())};u.useEffect(()=>{T()},[i,o,x,l]);const H=(r,S)=>{a(D=>({...D,surveys:D.surveys.map(k=>k.id===r?{...k,status:S}:k)}))},g=()=>{const r=_t.getUser().roles;return r.indexOf(Me.SUPER_ADMIN)>-1||r.indexOf(Me.SURVEY_ADMIN)>-1},[O,$]=u.useState(""),[A,L]=u.useState(""),[oe,ie]=u.useState(null),[le,V]=u.useState(!1),[ve,ce]=u.useState(v("action_btn.delete")),[W,q]=u.useState(!1),[w,Q]=u.useState(!1),[de,ee]=u.useState(!1),X=()=>{q(!0)},K=()=>{Q(!0)},ge=()=>{ee(!0),y(!0)},xe=()=>{q(!1)},tt=()=>{Q(!1)},at=r=>{L("delete"),ce(v("action_btn.delete")),ie(r),$(v("edit_survey.delete_survey",{survey_name:r.name})),V(!0)},st=r=>{L("close"),ce(v("action_btn.close")),ie(r),$(v("edit_survey.close_survey",{survey_name:r.name})),V(!0)},rt=()=>{A==="delete"?(nt(oe.id),V(!1)):A==="close"&&(ot(oe.id),V(!1))},Ee=r=>{F(r),y(!0)},nt=r=>{N(I(!0)),t.deleteSurvey(r).then(()=>{T()}).catch(S=>{N(I(!1))}).finally(()=>{N(I(!1))})},ot=r=>{N(I(!0)),t.closeSurvey(r).then(S=>{H(r,"closed")}).catch(S=>{S.name==me.INVALID_SURVEY_DATES.name&&setSurveyDateError(v("processed_errors.".concat(processed.name)))}).finally(()=>{N(I(!1))})},it=(r,S)=>{a(D=>{const k=D.surveys.map(P=>P.id===r?{...P,name:S}:P);return{...D,surveys:k}})},lt=(r,S)=>{a(D=>{const k=D.surveys.map(P=>P.id===r?{...P,description:S}:P);return{...D,surveys:k}})},ct=(r,S)=>{a(D=>{const k=D.surveys.map(P=>P.id===r?{...P,image:S}:P);return{...D,surveys:k}})},Oe=gt();return e.jsxs(C,{className:se.mainContainer,children:[e.jsx(xt,{sx:{marginBottom:"48px"},children:e.jsxs(C,{className:se.content,children:[e.jsxs(Z,{className:se.newSurveysButton,direction:"row",spacing:2,children:[g()&&!W&&e.jsx(te,{variant:"contained",color:"primary",startIcon:e.jsx(He,{}),onClick:X,children:v("create_new_survey")}),g()&&!w&&e.jsx(te,{variant:"contained",color:"primary",startIcon:e.jsx(Le,{}),onClick:K,children:v("copy_example_surveys")}),g()&&e.jsx(te,{variant:"contained",color:"primary",startIcon:e.jsx(Pt,{}),onClick:ge,children:v("import_survey")})]}),W&&e.jsx(Ae,{in:W,timeout:300,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(z,{onClick:xe,"aria-label":"close",style:{position:"absolute",top:0,...Oe==="ltr"?{right:0}:{left:0},color:"black",zIndex:1},children:e.jsx(Fe,{color:"#000"})}),e.jsx(is,{onSurveyCreated:r=>{T(),j(r.name),setTimeout(()=>j(null),3e3)}})]})}),w&&e.jsx(Ae,{in:w,timeout:300,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(z,{onClick:tt,"aria-label":"close",style:{position:"absolute",top:0,...Oe==="ltr"?{right:0}:{left:0},color:"black",zIndex:1},children:e.jsx(Fe,{color:"#000"})}),e.jsx(Ka,{onClone:r=>Ee(r)})]})}),(($e=s==null?void 0:s.surveys)==null?void 0:$e.length)>0?e.jsx(qa,{filter:l,onFilterSelected:r=>{n(1),b(r.target.value)},sort:x,onSortSelected:r=>{n(1),_(r.target.value)}}):e.jsx(e.Fragment,{}),e.jsx(C,{className:se.surveyCardsContainer,children:c?e.jsx(Ve,{}):e.jsx(e.Fragment,{children:((Pe=s==null?void 0:s.surveys)==null?void 0:Pe.length)>0?e.jsx(C,{sx:{mt:3,columnGap:2,display:"grid",rowGap:{xs:4,md:5},gridTemplateColumns:{xs:"1fr",sm:"repeat(auto-fit, minmax(280px, 1fr))",md:"repeat(auto-fit, minmax(330px, 350px))"}},children:(Re=s==null?void 0:s.surveys)==null?void 0:Re.map(r=>e.jsx(et,{survey:r,highlight:r.name===Y,onStatusChange:H,onClone:()=>Ee(r),onDelete:()=>at(r),onClose:()=>st(r),onUpdateTitle:it,onUpdateDescription:lt,onUpdateImage:ct},r.id))}):e.jsxs("div",{className:se.noSurveys,children:[e.jsx(qt,{sx:{fontSize:48,color:"#ccc"}}),e.jsxs(E,{variant:"h6",color:"textSecondary",sx:{mt:2},children:[v("create_survey.empty_state_message"),!w&&!W&&e.jsxs(e.Fragment,{children:[e.jsx(te,{variant:"contained",color:"primary",sx:{mx:1},startIcon:e.jsx(He,{}),onClick:X,children:v("create_new_survey")}),v("create_survey.or"),e.jsxs(te,{variant:"contained",color:"primary",sx:{mx:1},startIcon:e.jsx(Le,{}),onClick:K,children:[v("copy_example_surveys"),v("create_survey.empty_state_cta_copy")]})]})]})]})})}),((Ne=s==null?void 0:s.surveys)==null?void 0:Ne.length)>0?e.jsx(Ht,{rowsPerPageOptions:[5,10,20,50],component:"div",labelDisplayedRows:({from:r,to:S,count:D,page:k})=>v("responses.label_displayed_rows",{from:r,to:S,count:D}),labelRowsPerPage:v("responses.label_surveys_per_page"),count:s==null?void 0:s.totalCount,rowsPerPage:o,page:i-1,onPageChange:(r,S)=>{n(S+1)},onRowsPerPageChange:r=>{h(parseInt(r.target.value,10)),n(1)}}):e.jsx(e.Fragment,{})]})}),e.jsx(Rt,{importSurvey:de,open:f,onClose:r=>{y(!1),ee(!1),r&&T()},onSurveyCloned:r=>{j(r),setTimeout(()=>j(null),3e3)},survey:J}),e.jsx(Ct,{open:le,description:O,handleClose:()=>V(!1),handleDelete:rt,title:ve})]})}export{Rs as default};
